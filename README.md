# ESP32 Ready4Sky (R4S) gateway for Redmond+ devices
> **[A script based on a PHP server on a local network with Internet access to display the weather on the gateway screen.](https://github.com/artt652/Weather-for-ESP32-R4S-gate).**<br>
>**In versions starting from 2022.06.03, the device topics in gateway number 0 have been changed from ‚Äúr4s/#‚Äù to ‚Äúr4s0/#‚Äù. In new versions, topics in "r4s/#" are used to track tags by multiple gateways. When upgrading from older versions, you need to enable BLE Monitor in the settings (the gateway deletes the contents of "r4s/#" only when the monitor is turned on), selecting Passive, Active or Auto, check the Hass Discovery and Delete Mqtt Topics items and save the settings. After the reboot, the gateway will delete unnecessary topics and create them again. Then, if necessary, BLE Monitor can be disabled. Then fix the devices in automations, scripts, etc.**

#### Current version is 2024.02.05 –¥–ª—è [ESP32](https://github.com/alutov/ESP32-R4sGate-for-Redmond/raw/master/build/r4sGate.bin) –∏ [ESP32C3](https://github.com/alutov/ESP32-R4sGate-for-Redmond/raw/master/C3/build/r4sGate.bin).
* 2024.02.05. At startup, the gateway scans all WIFI APs with the required parameters and selects the AP with the best level. Relevant for mesh systems.
* 2024.02.04. Added selection of WIFI 802.11b/g/n mode in settings.
* 2024.02.02. Corrections by Delonghi. In Auto mode, the image buffer size is selected separately for each URL.
* 2024.01.30. Added the ability to automatically increase the buffer size for loading images within 10-65 kilobytes (Adjust option). The gateway operates more stable at wifi levels below -73dBm.
* 2024.01.25. Corrected Delonghi statistics and availability of BLE devices/tags in Home Assistant.
* 2024.01.22. Added mute option as an alternative to beep. The availability of devices in Home Assistant has been fixed. If the gateway is unavailable, all devices connected to it become unavailable. If devices disappear from the BLE monitor, the data from them becomes inaccessible. Added statistics to Delonghi coffee machines.
* 2024.01.14. The project was built using esp-idf version 5.2-beta2. Added Russian program names to the multicooker menu. Added support for the Redmond SkyHeat RCH-4560S heater. Added support for LYWSDCGQ thermometers to BLE Gateway Monitor. You can display up to 4 images in turn on the gateway screen using 4 urls.

## 1. Opportunities
&emsp; The ESP32 r4sGate gateway in a minimal configuration (only ESP32 or ESP32C3 with a 3.3v power supply) allows you to connect BLE-compatible Redmond devices, Xiaomi MiKettle kettles and some other devices to the smart home system (Home Assistant, OpenHab, ioBroker, MajorDoMo, etc. ) via MQTT protocol. Initially, the project was only for Redmond, now other devices are being added. Hence the plus in the name of the project.
<details>
<summary>Why MQTT...</summary>

* This is in fact a standard protocol for smart home systems. Another thing is how it is implemented. From the built-in MQTT server in the ioBroker system, where everything that happens in MQTT is immediately displayed in the admin interface, to the external broker in Home Assistant, where sometimes you have to use third-party utilities to configure it. In the latter, however, MQTT Discovery greatly simplifies the integration of devices into the system.
* In MQTT, devices can exchange data with each other, and not just with the smart home server. The gateway can be configured to display the readings of the main sensors in the house on the screen. In response to the argument that some devices can uncontrollably rewrite the data of others, I note that normal brokers have a shared access system (ACL). Although I don‚Äôt have an answer to the question, why even introduce devices into the system that are not trusted.
* In MQTT, devices can exchange information without knowing anything about each other except the topic where they should meet. This is used to determine the maximum signal strength from a tag/beacon among multiple gateways, and the gateway receiving the strongest signal.
* MQTT support is included in the esp-idf development environment and does not require third-party libraries. After unsuccessful attempts to finalize a very good [olehs project](https://github.com/olehs/r4sGate) on arduino, I became a supporter of pure esp-idf.
</details>     

#### List of supported devices:

**Electric kettles:**
* Redmond SkyKettle **RK-M170S**
* Redmond SkyKettle **RK-M173S** / RK-M171S / RTP-M810S
* Redmond SkyKettle **RK-G200S** / RK-G204S / RK-G210S / RK-G211S / RK-G212S / RK-G214S / RK-M216S / RK-M139S
* Redmond SkyKettle **RK-G240S** / RK-G204S / RK-G210S / RK-G211S / RK-G212S / RK-G214S / RK-M216S / RK-M139S
* Xiaomi MiKettle **YM-K1501(Int)** - ProductId 275
* Xiaomi MiKettle **YM-K1501(HK)** - ProductId 131
* Xiaomi MiKettle **V-SK152(Int)** - ProductId 1116
<details>
<summary>Read more about Xiaomi MiKettle...</summary>
&emsp;Xiaomi MiKettle can only be controlled from the **keep warm** mode. In this mode, the kettle maintains a minimum temperature of 40¬∞C set by the gateway with a hysteresis of approximately 4¬∞C, that is, at 36¬∞C the heating is turned on, and at 44¬∞C it is turned off. You can turn boiling on and off (state = ON/OFF), set the heating temperature (heat_temp = 40...95). You can switch the kettle to Idle mode (heat_temp = 0). The last command is executed with a delay. After executing the command, further control of the kettle is unavailable. In contrast to turning it off with the **warm** sensor on the kettle, when you turn it off and on again, the kettle returns to the **keep warm** mode. Perhaps this is a feature of a specific version of MCU 6.2.1.9. For now I left it like that and turned on the kettle through the Redmond outlet. If you turn it off and on again, the kettle goes into heating mode. The gateway installs all the necessary parameters of the kettle itself, and the native application is useful for updating the firmware. The heating time is set to 12 hours (720 minutes), after 256 minutes the gateway resets the counter by briefly turning the boiling on and off. And still control is limited. The main problem is that when you turn on boiling with the **boil** sensor on the kettle, the **keep warm** mode is turned off and you can return it only with the **warm** button on the kettle. For the same reason, I postponed work on Mikettle Pro for now.</details>

**Multicookers**

* Redmond SkyCooker **RMC-M224S**
* Redmond SkyCooker **RMC-M800S**
* Redmond SkyCooker **RMC-M903S**
* Redmond SkyCooker **RMC-M92S**
* Redmond SkyCooker **RMC-M961S**
     
**Coffee makers**

* Redmond SkyCoffee **RCM-M1519S**

**Coffee machines**

* Delonghi **ECAM650.75** (Possibly other models üòâ Primadonna Elite series)

**Sockets**

* Redmond SkyPort **RSP-103S** / RSP-100S

**Electric convectors**

* Redmond SkyHeat **RCH-7001S** / RCH-7002S / RCH-7003S
* Redmond SkyHeat **RCH-4560S**

**Climate stations**

* Redmond SkyClimate **RSC-51S**

**Humidifiers**

* Redmond SkyDew **RHF-3310S**

**Sensors**

* Redmond SkySmoke **RSS-61S** - smoke sensor
* Redmond SkyOpen **RSO-31**  - door open sensor
* Hilink **HLK-LD2410B** - motion and presence sensor

**Irrigation controllers**
     
* Galcon **GL9001A** / Green Apple GATB010-03

**Curtain/blind drivers**
     
* **AM43 blinds** A-OK and similar)

&emsp;The gateway supports 5 simultaneous BLE connections. Device management is also possible from the gateway web interface. The web interface is [simply protected with a password from Raerten](https://github.com/alutov/ESP32-R4sGate-for-Redmond/pull/67). To do this, the string in the form login:password must be encrypted in Base 64 and then entered into the Basic Auth field in the settings. The password string is output to the log when the gateway starts.<br/>
&emsp;–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è Home Assistant Mqtt Discovery. –î–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –Ω—É–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å **Hass Discovery** –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö. –ü—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–¥–∞–ª–µ–Ω–∏—è –≤—Å–µ—Ö —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —à–ª—é–∑–æ–º –¥–∞–Ω–Ω—ã—Ö –≤ Mqtt –∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ Home Assistant. –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –≤–æ –≤–∫–ª–∞–¥–∫–µ **Setting** –æ–ø—Ü–∏—é **Delete Mqtt topics** –∏ –∑–∞—Ç–µ–º –Ω–∞–∂–∞—Ç—å **Save setting**. –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —à–ª—é–∑–∞ –±—É–¥—É—Ç –∑–∞–Ω–æ–≤–æ —Å–æ–∑–¥–∞–Ω—ã —Ç–æ–ª—å–∫–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ –∫ —à–ª—é–∑—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ —à–ª—é–∑–∞ –∏ —Ä–µ–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å —É–¥–∞–ª–µ–Ω–∏–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤.<br> 

<details>
<summary>–ü—Ä–æ—Å—Ç–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —á–∞–π–Ω–∏–∫–∞ –∏–∑ Home Assistant –≤ —É–º–Ω—ã–π –¥–æ–º –Ø–Ω–¥–µ–∫—Å–∞ - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–Ω–æ—Å—Ç—å –∫–ª–∏–º–∞—Ç–∞.</summary>

&emsp; –ò –Ω–∞–∑–≤–∞—Ç—å –µ–≥–æ —Å–ª–æ–≤–æ–º **—á–∞–π–Ω–∏–∫**. –î–æ—Å—Ç—É–ø–Ω—ã –±—É–¥—É—Ç –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–µ—Ä–º–æ—Å—Ç–∞—Ç. –ù–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–º–∞–Ω–¥–∞ **–≤–∫–ª—é—á–∏ —á–∞–π–Ω–∏–∫** (—Ä–µ–∂–∏–º auto, –≤–∫–ª—é—á–µ–Ω–∏–µ –∫–∏–ø—è—á–µ–Ω–∏–µ –∏–ª–∏ –∫–∏–ø—è—á–µ–Ω–∏–µ —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º –ø–æ–¥–æ–≥—Ä–µ–≤–æ–º, –µ—Å–ª–∏ –¥–æ —ç—Ç–æ–≥–æ –±—ã–ª –≤–∫–ª—é—á–µ–Ω –ø–æ–¥–æ–≥—Ä–µ–≤), **–≤—ã–∫–ª—é—á–∏ —á–∞–π–Ω–∏–∫** (–≤—ã–∫–ª—é—á–∞–µ—Ç –≤—Å–µ), **—É—Å—Ç–∞–Ω–æ–≤–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É —á–∞–π–Ω–∏–∫–∞ 40&deg;** (–µ—Å–ª–∏ –Ω–µ 0&deg;  –∏ –Ω–µ 100&deg; –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–¥–æ–≥—Ä–µ–≤, —Ä–µ–∂–∏–º heat,  –µ—Å–ª–∏ 0&deg; - –≤—ã–∫–ª—é—á–∞–µ—Ç, –µ—Å–ª–∏ –∂–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ 100&deg;, –≤–∫–ª—é—á–∞–µ—Ç—Å—è –∫–∏–ø—è—á–µ–Ω–∏–µ, —Ä–µ–∂–∏–º auto) –ª–∏–±–æ **–≤–∫–ª—é—á–∏ –æ–±–æ–≥—Ä–µ–≤** (–≤–∫–ª—é—á–∞–µ—Ç –ø–æ–¥–æ–≥—Ä–µ–≤ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–æ–π). –ò, –Ω–∞–∫–æ–Ω–µ—Ü, –∫–æ–º–∞–Ω–¥–∞ **–≤–∫–ª—é—á–∏ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ** - –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–¥—Å–≤–µ—Ç–∫—É, —Ä–µ–∂–∏–º cool. –ù–µ –æ—á–µ–Ω—å –∫—Ä–∞—Å–∏–≤–æ, –Ω–æ –∫–∞–∫ –µ—Å—Ç—å. –ú–æ–∂–Ω–æ —Å–ø—Ä–æ—Å–∏—Ç—å, **—á—Ç–æ —Ç–∞–º —Å —á–∞–π–Ω–∏–∫–æ–º** - **—Ç–µ—Ä–º–æ—Å—Ç–∞—Ç —á–∞–π–Ω–∏–∫ –≤—ã–∫–ª—é—á–µ–Ω** –∏ **–∫–∞–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —á–∞–π–Ω–∏–∫–∞** - —Å–∫–∞–∂–µ—Ç —Ç–µ–∫—É—â—É—é —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É. <br>
</details>     

<details>
<summary>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤–æ–¥—ã –≤ —á–∞–π–Ω–∏–∫–µ –ø—Ä–∏ –Ω–∞–≥—Ä–µ–≤–µ –≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ 65-85&deg;C –∏ –±–æ–ª–µ–µ 3&deg;C —Å –º–æ–º–µ–Ω—Ç–∞ –≤–∫–ª—é—á–µ–Ω–∏—è —á–∞–π–Ω–∏–∫–∞.</summary>

&emsp;–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∏–∫–∞–∫–∏—Ö –¥–æ—Ä–∞–±–æ—Ç–æ–∫ —á–∞–π–Ω–∏–∫–∞. –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–∞—Ç—Ä–∞—á–µ–Ω–Ω–æ–π —ç–Ω–µ—Ä–≥–∏–∏ –∏ —Ä–∞–∑–Ω–æ—Å—Ç–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä. –í—ã—á–∏—Å–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–Ω—è—Ç–∏–∏ —á–∞–π–Ω–∏–∫–∞ —Å –ø–æ–¥—Å—Ç–∞–≤–∫–∏. –û–ø—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ —á–∞–π–Ω–∏–∫–∞—Ö —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π. –ö–ü–î —á–∞–π–Ω–∏–∫–∞ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –ø—Ä–∏–Ω—è—Ç 80%. –¢–æ—á–Ω–æ—Å—Ç—å —Ç–∞–∫ —Å–µ–±–µ, —É –º–µ–Ω—è –≤—ã—Ö–æ–¥–∏—Ç –≥–¥–µ-—Ç–æ ~0.2 –ª–∏—Ç—Ä–∞. –î–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω —Ä–µ–∂–∏–º –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ö–ü–î. –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –∑–∞–ª–∏—Ç—å –≤ —á–∞–π–Ω–∏–∫ 1–ª –≤–æ–¥—ã –∏ –≤—ã–±—Ä–∞—Ç—å –≤ web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ **Boil 1l on**. –ö–æ–≥–¥–∞ —Ä–µ–∂–∏–º –æ—Ç—Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω—É–∂–Ω–æ –∑–∞–π—Ç–∏ –≤ —Ä–µ–∂–∏–º –Ω–∞—Å—Ç—Ä–æ–µ–∫. –ù–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –±—É–¥–µ—Ç –≤—ã–≤–µ–¥–µ–Ω–æ —Å—Ä–∞–∑—É –∑–∞ —Ç–∏–ø–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞. –ó–∞–ø–∏—Å–∞—Ç—å –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ nvram –º–æ–∂–Ω–æ –∫–æ–º–∞–Ω–¥–æ–π Save setting. –ö–∞–∫ –º–Ω–µ –¥—É–º–∞–µ—Ç—Å—è, –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª—å—à—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–µ—Ä–µ–∞–ª—å–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –ö–ü–î —á–∞–π–Ω–∏–∫–∞ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º –º–µ–Ω—è–µ—Ç—Å—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å –ø–æ—è–≤–ª–µ–Ω–∏–µ–º –Ω–∞–∫–∏–ø–∏, –∏, —á—Ç–æ —Ö—É–∂–µ, –∑–∞—Ç—Ä–∞—á–µ–Ω–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è –Ω–µ –∏–∑–º–µ—Ä—è–µ—Ç—Å—è, –∞ –ø—Ä–æ—Å—Ç–æ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–º —á–∞–π–Ω–∏–∫–∞ –∏—Å—Ö–æ–¥—è –∏–∑ –Ω–æ–º–∏–Ω–∞–ª—å–Ω–æ–π –º–æ—â–Ω–æ—Å—Ç–∏ –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è –∏ –≤—Ä–µ–º–µ–Ω–∏ –µ–≥–æ —Ä–∞–±–æ—Ç—ã. –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –ø–∏—Ç–∞—é—â–µ–≥–æ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ –æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ –∫–∞–ª–∏–±—Ä–æ–≤–∫–µ –≤–Ω–æ—Å–∏—Ç –∑–∞–º–µ—Ç–Ω—É—é –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Ç–∞–º –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è. –£ –º–µ–Ω—è –ø—Ä–∏ –∫–∏–ø—è—á–µ–Ω–∏–∏ —á–∞–π–Ω–∏–∫–æ–º RK-M216S 1.7 –ª–∏—Ç—Ä–∞ –≤–æ–¥—ã –ø—Ä–∏ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–∏ –Ω–∞ –≤—Ö–æ–¥–µ –≤ –¥–æ–º 200-204V –≤ –∏—Ç–æ–≥–µ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è 1.8 –ª–∏—Ç—Ä–∞, –ø—Ä–∏ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–∏ 210-214V –≤—ã—Ö–æ–¥–∏—Ç 1.6 –ª–∏—Ç—Ä–∞. –ü—Ä–∏ –∫–∞–ª–∏–±—Ä–æ–≤–∫–µ –æ—á–µ–≤–∏–¥–Ω–æ –±—ã–ª–æ —á—Ç–æ-—Ç–æ —Å—Ä–µ–¥–Ω–µ–µ.<br>
</details>     

&emsp;BLE –º–æ–Ω–∏—Ç–æ—Ä —à–ª—é–∑–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –¥–æ 24 BLE —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –º–µ—Ç–æ–∫/(–º–∞—è–∫–æ–≤) —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º MAC –∞–¥—Ä–µ—Å–æ–º. –í—ã–≤–æ–¥–∏—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ/–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–µ—Ç–∫–∏(–º–∞—è–∫–∞) –∏ rssi. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è BLE –º–∞—è–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Home Assistant –Ω–∞ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–∞—Ö (–ø—Ä–∏–≤—è–∑–∫–∞ –ø–æ uuid), LYWSD02 —á–∞—Å—ã —Å —Ç–µ—Ä–º–æ–º–µ—Ç—Ä–æ–º, LYWSD03MMC —Ç–µ—Ä–º–æ–º–µ—Ç—Ä—ã Xiaomi Mijia 2 —Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π –ø—Ä–æ—à–∏–≤–∫–æ–π, [–ø—Ä–æ—à–∏–≤–∫–æ–π –æ—Ç atc1441 –≤ —Ä–µ–∂–∏–º–µ custom](https://github.com/atc1441/ATC_MiThermometer) –∏ [–ø—Ä–æ—à–∏–≤–∫–æ–π –æ—Ç pvvx –≤ —Ä–µ–∂–∏–º–µ custom](https://github.com/pvvx/ATC_MiThermometer), Xiaomi Mi Scale, Qingping Air Monitor Lite(CGDN1), —Å—á–µ—Ç—á–∏–∫–∏ Elehant, –∞ —Ç–∞–∫–∂–µ Samsung Smart Tag.<br>
&emsp;–ü—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–æ 10 –ø–æ—Ä—Ç–æ–≤ –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞, 5 –∏–∑ –Ω–∏—Ö –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–Ω–µ—à–Ω–∏–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏(—Ä–µ–∂–∏–º Out) –∏ —á—Ç–µ–Ω–∏—è –∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è(—Ä–µ–∂–∏–º In). –¢—Ä–∏ –ø–æ—Ä—Ç–∞ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–∞–∫ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è - –≤—ã–∫–ª—é—á–µ–Ω–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö BLE —É—Å—Ç—Ä–æ–π—Å—Ç–≤(—Ä–µ–∂–∏–º Sw, –ø—Ä–∏ —ç—Ç–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –≤ mqtt –Ω–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è), —á–µ—Ç–≤–µ—Ä—Ç—ã–π –ø–æ—Ä—Ç - –∫–∞–∫ –∫–Ω–æ–ø–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ —Å –∫–∞–º–µ—Ä—ã. –ü—Ä–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ —Ä–µ–∂–∏–º–µ –≤—Ö–æ–¥–∞ –≤–∫–ª—é—á–∞–µ—Ç—Å—è pullup, –µ—Å–ª–∏ —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ (–Ω–æ–º–µ—Ä –ø–∏–Ω–∞ –º–µ–Ω—å—à–µ 34). –ï—â–µ 2 –ø–æ—Ä—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —à–∏–Ω–æ–π I2C, –∞ –∫–∞–∂–¥—ã–π –∏–∑ 3-—Ö –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –ø–æ—Ä—Ç–æ–≤ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ –≤—ã—Ö–æ–¥ —Å —à–∏—Ä–æ—Ç–Ω–æ - –∏–º–ø—É–ª—å—Å–Ω–æ–π –º–æ–¥—É–ª—è—Ü–∏–µ–π (PWM), –∏–ª–∏ –∂–µ –∫–∞–∫ –≤—Ö–æ–¥ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–ª–∏ –æ–¥–Ω–æ–≥–æ –¥–∞—Ç—á–∏–∫–∞ DS18B20 —Å –ø—Ä—è–º—ã–º –ø–∏—Ç–∞–Ω–∏–µ–º, –∏–ª–∏ –æ–¥–Ω–æ–≥–æ –¥–∞—Ç—á–∏–∫–∞ DHT22/AM2302 (7 –∏ 8 –ø–æ—Ä—Ç). –ü—Ä–æ—Ü–µ–¥—É—Ä—ã —á—Ç–µ–Ω–∏—è —É–ø—Ä–æ—â–µ–Ω—ã, –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—É–º–º–∞ –Ω–µ —á–∏—Ç–∞–µ—Ç—Å—è –∏ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, –¥–∞–Ω–Ω—ã–µ –æ–∫—Ä—É–≥–ª—è—é—Ç—Å—è –¥–æ –æ–¥–Ω–æ–≥–æ –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π. –ï—Å–ª–∏ —à–ª—é–∑ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω –∑–≤—É–∫–æ–≤—ã–º –∏–∑–ª—É—á–∞—Ç–µ–ª–µ–º, —Ç–æ, –ø–æ–¥–∫–ª—é—á–∏–≤ –∫ –Ω–µ–º—É –≤—ã—Ö–æ–¥ PWM (–≤ m5stack basic —ç—Ç–æ gpio 25), –º–æ–∂–Ω–æ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –≤—ã–≤–æ–¥ –∑–≤—É–∫–æ–≤–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞. –ò–∑–º–µ–Ω—è—è —Å–∫–≤–∞–∂–Ω–æ—Å—Ç—å –∏–º–ø—É–ª—å—Å–æ–≤, –º–æ–∂–Ω–æ —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞—Ç—å –≥—Ä–æ–º–∫–æ—Å—Ç—å. –ß–∞—Å—Ç–æ—Ç–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –∏ —Ä–∞–≤–Ω–∞ 3.136 kHz. –®–∏–Ω–∞ I2C –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–∞—Ç—á–∏–∫–∏ SHT3x/SHT4X(–∞–¥—Ä–µ—Å–∞ 0x44, 0x45), AHT20(0x38), HTU21(0x40), BMP280/BME280/680/688(0x76, 0x77, 688 –ø–æ–∫–∞ –Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω), SGP30(0x58), SGP4x(0x59), SCD4x(0x62), –∞ —Ç–∞–∫–∂–µ RTC DS3231(0x68) –∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –±–∞—Ç–∞—Ä–µ–∏ IP5306(0x75). –ü—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ SGP30 –≤ NVRAM –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Ö –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —à–ª—é–∑–∞. –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å –ø—É–Ω–∫—Ç AQ base –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö. –î–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è VOC –≤ SGP4x –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è [–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Sensirion](https://github.com/Sensirion/gas-index-algorithm). –ß–∞—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ —Å NTP —Å–µ—Ä–≤–µ—Ä–∞, –¥–∞—Ç—á–∏–∫ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ Mqtt. –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä IP5306 —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ m5stack –∏ ttgo-t4 (SCL 22, SDA 21), –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —É—Ä–æ–≤–µ–Ω—å –±–∞—Ç–∞—Ä–µ–∏ —Å —à–∞–≥–æ–º 25% –∏ –µ–µ —Ä–µ–∂–∏–º (Discarging / Charging / Charged). –ü—Ä–∏ –ø–∏—Ç–∞–Ω–∏–∏ –æ—Ç –±–∞—Ç–∞—Ä–µ–∏ —è—Ä–∫–æ—Å—Ç—å —ç–∫—Ä–∞–Ω–∞ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –≤ 16 —Ä–∞–∑. –®–ª—é–∑ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–∞–∫–∂–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –ø–∏—Ç–∞–Ω–∏—è AXP192 –∏ RTC PCF8563, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –µ–º—É —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ M5Stack Tough, –∞ —Ç–∞–∫–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç ADC —Ç–µ–Ω–∑–æ–¥–∞—Ç—á–∏–∫–æ–≤ HX711. –†–µ–∑—É–ª—å—Ç–∞—Ç –∏–∑–º–µ—Ä–µ–Ω–∏—è —Å HX711 –º–æ–∂–Ω–æ –≤—ã–≤–æ–¥–∏—Ç—å –∫–∞–∫ –≤ –∫–∏–ª–æ–≥—Ä–∞–º–º–∞—Ö, —Ç–∞–∫ –∏ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏. HX711 –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 4 —Å–µ–∫—É–Ω–¥—ã, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –¥–∞—Ç—á–∏–∫–∏ —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 12 —Å–µ–∫—É–Ω–¥. –®–ª—é–∑ –¥–æ–ø—É—Å–∫–∞–µ—Ç –≥–æ—Ä—è—á–µ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–µ–Ω—Å–æ—Ä–æ–≤. –î–∞—Ç—á–∏–∫–∏ 18B20 –∏ DHT22 –ø–æ—è–≤–ª—è—é—Ç—Å—è –≤ Mqtt –∏ Home Assistant —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Å—Ç–∞—Ä—Ç–∞ —à–ª—é–∑–∞, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã, –∞ I2C —Å–µ–Ω—Å–æ—Ä—ã –ø–æ –º–µ—Ä–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏—Ö –Ω–∞ —à–∏–Ω–µ –≤ —Ç–µ—á–µ–Ω–∏–µ 2-—Ö —Ü–∏–∫–ª–æ–≤ –æ–ø—Ä–æ—Å–∞ (24 —Å–µ–∫—É–Ω–¥—ã).    
<details>
     <summary>–ï—Å—Ç—å —Ç–∞–∫–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ IR –ø–µ—Ä–µ–¥–∞—Ç—á–∏–∫–∞ (IR Tx, 6 –ø–æ—Ä—Ç).</summary>

&emsp;–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –ø—Ä–æ—Ç–æ–∫–æ–ª—ã **NEC** (8 –∏ 16 –±–∏—Ç–Ω—ã–π –∞–¥—Ä–µ—Å) **RC5** (–¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ —Ä–µ–∂–∏–º–µ RC5ext –Ω—É–∂–Ω–æ –∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å 6 –±–∏—Ç –∫–æ–º–∞–Ω–¥—ã), **RC6**, **Samsung**, Sony **SIRC** (12, 15 –∏ 20 –±–∏—Ç), **Panasonic**. –£–ø—Ä–∞–≤–ª—è—Ç—å –º–æ–∂–Ω–æ –∫–∞–∫ –∏–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ Home Assistant –∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ç–æ–ø–∏–∫–æ–≤ –∞–¥—Ä–µ—Å–∞, –∫–æ–º–∞–Ω–¥—ã –∏ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞, —Ç–∞–∫ –∏ –ø—Ä—è–º–æ–π –∑–∞–ø–∏—Å—å—é –≤ —Ç–æ–ø–∏–∫ **r4sx/ir6code** (–≥–¥–µ **x** - –Ω–æ–º–µ—Ä —à–ª—é–∑–∞) —Å—Ç—Ä–æ–∫–∏ –∏–∑ 8 hex —Å–∏–º–≤–æ–ª–æ–≤ 0-9,a-f, –Ω–∞–ø—Ä–∏–º–µ—Ä, **090a1c3d**, –≥–¥–µ **09** - –ø—Ä–æ—Ç–æ–∫–æ–ª(01-nec, 02-necx16, 03-rc5, 04-rc6, 05-samsung, 06-sircx12, 07-sircx15, 08-sircx20, 09-panasonic), **0a1c** - –∞–¥—Ä–µ—Å, **3d** -–∫–æ–º–∞–Ω–¥–∞.<br>
–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ (–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–ª–∞ –∫–æ–º–∞–Ω–¥–∞ –≤–∫–ª—é—á–µ–Ω–∏—è –ø–∏—Ç–∞–Ω–∏—è):<br>
**NEC:** pioneer vsx-830, power: addr 165, cmd 28, code 0100a51c<br>
**NECx16:** lg dvd dks-2000h, power: addr 11565, cmd 48, code 022d2d30<br> 
**RC6:** philips 40pfs6609, power: addr 0, cmd 12, code 0400000c<br>
**SAMSUNG:** ue32n5300, power: addr 7, cmd 2, code 05000702<br>
**SIRCx12:** sony cmt-sx7, power: addr:16, cmd: 21, code 06001015<br>
**SIRCx20:** sony ubp-x800 power: addr 7258, cmd 21, code 081c5a15<br>
**PANASONIC:** sa-pm20 power: addr 2588, cmd 61, code 090a1c3d<br>
**PANASONIC:** dmp-ub900 power: addr 2816, cmd 61, code 090b003d<br>
–ü—Ä–æ–≤–µ—Ä—è–ª –≤—Å–µ –Ω–∞ Atom lite, –≤ –Ω–µ–º –µ—Å—Ç—å IR LED –Ω–∞ 12 gpio. –ü–æ–∫–∞ –Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã RC5 –∏ SIRCx15.<br>
</details>

&emsp;–° —Ü–µ–ª—å—é —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π —à–ª—é–∑–∞ –≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ TFT —ç–∫—Ä–∞–Ω–∞ 320 * 240 –Ω–∞ —á–∏–ø–∞—Ö ili9341, ili9342 –∏ ST7789. –ù–∞ —ç–∫—Ä–∞–Ω –≤—ã–≤–æ–¥–∏—Ç—Å—è —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è, –¥–∞—Ç–∞, –∞ —Ç–∞–∫–∂–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ –∏ —Ç–æ–∫  –≤ –¥–æ–º–µ (–Ω–µ –ø–æ–º–µ—à–∞–µ—Ç –ø—Ä–∏ –ø–∏—Ç–∞–Ω–∏–∏ –æ—Ç –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞), —Å–æ—Å—Ç–æ—è–Ω–∏–µ (—Å–∏–Ω–∏–π- –≤—ã–∫–ª., –∫—Ä–∞—Å–Ω—ã–π - –≤–∫–ª.) –∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–∞ –≤—ã—Ö–æ–¥–µ –∫–æ—Ç–ª–∞, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∏ –≤–ª–∞–∂–Ω–æ—Å—Ç—å –Ω–∞ —É–ª–∏—Ü–µ. –í—Å–µ –±–µ—Ä–µ—Ç—Å—è —Å Mqtt. –†—è–¥–æ–º —Å –¥–∞—Ç–æ–π —Ü–≤–µ—Ç–æ–º –≤—ã–≤–æ–¥–∏—Ç—Å—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ BLE —É—Å—Ç—Ä–æ–π—Å—Ç–≤, 1 ... 5 - —Å –ø–µ—Ä–≤–æ–≥–æ –ø–æ –ø—è—Ç–æ–µ. –°–µ—Ä—ã–π - –Ω–µ –Ω–∞ —Å–≤—è–∑–∏ –∏–ª–∏ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ, —Å–∏–Ω–∏–π - –≤—ã–∫–ª—é—á–µ–Ω–æ, –∫—Ä–∞—Å–Ω—ã–π - –≤–∫–ª—é—á–µ–Ω–æ, –∂–µ–ª—Ç—ã–π - –ø–æ–¥–æ–≥—Ä–µ–≤, –±–µ–ª—ã–π - —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞. –ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö BLE —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø–æ –æ—á–µ—Ä–µ–¥–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –Ω–∏–∂–Ω–µ–π —Å—Ç—Ä–æ–∫–µ. –ï—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–≥–æ –∏–ª–∏ –ø–æ –∑–∞–ø—Ä–æ—Å—É –∫–Ω–æ–ø–∫–æ–π –≤—ã–≤–æ–¥–∞ –Ω–∞ —ç–∫—Ä–∞–Ω –∫–∞—Ä—Ç–∏–Ω–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ jpeg, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å –∫–∞–º–µ—Ä—ã.  –ö–∞—Ä—Ç–∏–Ω–∫–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ –≤—ã—à–µ 320 –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –º–∞—Å—à—Ç–∞–±–µ 1:2. –†–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 20-65 –∫–∏–ª–æ–±–∞–π—Ç. –Ø—Ä–∫–æ—Å—Ç—å —ç–∫—Ä–∞–Ω–∞ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å –ø–æ Mqtt. –ú–æ–∂–Ω–æ —Ç–∞–∫–∂–µ –Ω–∞ —ç–∫—Ä–∞–Ω –≤—ã–≤–æ–¥–∏—Ç—å –ø–æ–≥–æ–¥—É –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º –≤–∏–¥–∞ —Å —Å–∞–π—Ç–∞ wttr.in –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —Ç–µ–∫—Å—Ç, –∑–∞–ø–∏—Å—ã–≤–∞—è –µ–≥–æ –≤ Mqtt —Ç–æ–ø–∏–∫ r4sx/jpg_url. –ü–æ–ª—É—á–∏–ª–æ—Å—å —á—Ç–æ-—Ç–æ –ø–æ—Ö–æ–∂–µ–µ –Ω–∞ —á–∞—Å—ã —Å —Ç–µ—Ä–º–æ–º–µ—Ç—Ä–æ–º. –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≥–ª—è–Ω—É—Ç—å –Ω–∞ —ç–∫—Ä–∞–Ω, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è, –≤—Å–µ –ª–∏ –≤ –ø–æ—Ä—è–¥–∫–µ –≤ –¥–æ–º–µ, —á—Ç–æ —Ç–∞–º —Å–µ–≥–æ–¥–Ω—è –Ω–∞ —É–ª–∏—Ü–µ.<br>

## 2. –ö–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ

![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/myparts.jpg)
–ö–∞—Ä—Ç–∏–Ω–∫–∞ 1. –ö–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ –¥–ª—è —Å–±–æ—Ä–∫–∏ —à–ª—é–∑–∞.

&emsp; –ï—Å–ª–∏ —Ü–µ–ª—å –∑–∞–ø—É—Å—Ç–∏—Ç—å —à–ª—é–∑ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –∑–∞—Ç—Ä–∞—Ç–∞–º–∏, –ø—Ä–∏–¥–µ—Ç—Å—è –ø–æ–∫—É–ø–∞—Ç—å –∑–∞–ø—á–∞—Å—Ç–∏, –∑–∞—Ç–µ–º —Å–æ–±–∏—Ä–∞—Ç—å –∏–∑ –Ω–∏—Ö —à–ª—é–∑. –Ø –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª [ESP32 WROOM ESP-32 4 –ú–± —Å –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –∞–Ω—Ç–µ–Ω–Ω–æ–π (—Å–ª–µ–≤–∞ –≤–Ω–∏–∑—É) –∏–ª–∏ ESP32 WROOM ESP-32U 4 –ú–± —Å –≤–Ω–µ—à–Ω–µ–π (–ø—Ä–∞–≤–µ–µ –ø–µ—Ä–≤–æ–π)](https://aliexpress.ru/item/32961594602.html?item_id=32961594602&sku_id=66888778667&spm=a2g2w.productlist.0.0.4f835c61Fvd1gD). –¶–µ–Ω–∞ –≤–æ–ø—Ä–æ—Å–∞ $2.5. –ü–æ—Ç–æ–º –ø–∞—è–ª –º–∏–∫—Ä–æ—Å—Ö–µ–º—É –Ω–∞ [–∞–¥–∞–ø—Ç–µ—Ä-–ø–ª–∞—Ç—É($0.3)](https://www.aliexpress.com/item/32763489487.html?spm=a2g2w.productlist.i0.2.48d33c75KbnjpB&sku_id=62208988599) –∏ –¥–∞–ª–µ–µ –Ω–∞ –º–∞–∫–µ—Ç–Ω—É—é –ø–ª–∞—Ç—É. –ü–æ–¥–æ–π–¥–µ—Ç —Ç–∞–∫–∂–µ ESP32C3, —É –º–µ–Ω—è —ç—Ç–æ ESP32C3-12F. –ò–∑-–∑–∞ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π —ç—Ç–æ–π –º–∏–∫—Ä–æ—Å—Ö–µ–º—ã —à–ª—é–∑ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Ä—Ç8 —Ç–æ–ª—å–∫–æ –∫–∞–∫ –≤—ã—Ö–æ–¥ —Å —à–∏—Ä–æ—Ç–Ω–æ - –∏–º–ø—É–ª—å—Å–Ω–æ–π –º–æ–¥—É–ª—è—Ü–∏–µ–π (PWM). C–≤–æ–±–æ–¥–Ω–æ–π –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ –±–æ–ª—å—à–µ –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ 28 –∫–∏–ª–æ–±–∞–π—Ç. –ò –¥–∞–∂–µ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω–æ–º —ç–∫—Ä–∞–Ω–µ —É ESP32C3-12F –æ—Å—Ç–∞–µ—Ç—Å—è –µ—â–µ 6 —Å–≤–æ–±–æ–¥–Ω—ã—Ö gpio. –ò—Å—Ç–æ—á–Ω–∏–∫ –ø–∏—Ç–∞–Ω–∏—è –Ω–∞ 3.3 Hi-Link($2-$4). [–Ø –∏—Ö –±—Ä–∞–ª –ø–æ —Ü–µ–Ω–µ $1.65](https://aliexpress.ru/item/32953853140.html?spm=a2g39.orderlist.0.0.32964aa6PePEbg&_ga=2.238912000.104655408.1636114275-428746708.1615828563&_gac=1.87036010.1634012869.Cj0KCQjwwY-LBhD6ARIsACvT72Na1GBQp7leEJDlxPCd0jTye8sF-GiknWzlo4hKElMNbtmI4DYpB_8aAktOEALw_wcB). **–ú–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏—Å—å –±–µ–∑ –ø–∞–π–∫–∏**, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å [esp32-wroom-devkit(–≤–Ω–∏–∑—É –≤ —Ü–µ–Ω—Ç—Ä–µ, $14)](https://aliexpress.ru/item/4000127837743.html?sku_id=10000000372418546&spm=a2g0s.9042311.0.0.274233edNcajyj). –ü—Ä–∞–≤–¥–∞, —ç—Ç–∞ –ø–ª–∞—Ç–∞ —Å–∏–ª—å–Ω–æ –∏–∑–±—ã—Ç–æ—á–Ω–∞ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞, [–º–æ–∂–Ω–æ –≤–∑—è—Ç—å –ø–æ–ø—Ä–æ—â–µ –∑–∞ $3.54](https://aliexpress.ru/item/32928267626.html?item_id=32928267626&sku_id=12000016847177755&spm=a2g2w.productlist.0.0.430c65c8Kf9vOT). –í –Ω–µ–º esp32 –∏–¥–µ—Ç –≤–º–µ—Å—Ç–µ —Å –ø–ª–∞—Ç–æ–π, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π –µ—Å—Ç—å –µ—â–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª–∏ —Å 5–≤ –Ω–∞ 3.3–≤, USB-RS232 –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–∞–∑—ä–µ–º –º–∏–Ω–∏-USB. –ß–µ—Ä–µ–∑ –Ω–µ–≥–æ –º–æ–∂–Ω–æ –ø–∏—Ç–∞—Ç—å esp32, –∏—Å–ø–æ–ª—å–∑—É—è –ø—è—Ç–∏–≤–æ–ª—å—Ç–æ–≤–æ–µ –∑–∞—Ä—è–¥–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –æ—Ç —Å–º–∞—Ä—Ç—Ñ–æ–Ω–∞, –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞—Ç—å –ø—Ä—è–º–æ —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –±–µ–∑ –≤—Å—è–∫–∏—Ö –ø–µ—Ä–µ—Ö–æ–¥–Ω–∏–∫–æ–≤. –ò —Å–ø—Ä–∞–≤–∞ –Ω–∞ —Ñ–æ—Ç–æ [3.2" 320 * 240 TFT —ç–∫—Ä–∞–Ω($18)](https://aliexpress.ru/item/32911859963.html?spm=a2g0s.9042311.0.0.274233edzZnjSp), –∫–æ—Ç–æ—Ä—ã–π —è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤ —à–ª—é–∑–µ. –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –≥–æ—Ç–æ–≤—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∫–∞–∫ —Å —ç–∫—Ä–∞–Ω–æ–º (**TTGO T-Watcher BTC Ticker**, **M5Stack BASIC**, **M5Stack Tough**), —Ç–∞–∫ –∏ –±–µ–∑ (**m5atom lite**).

## 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —à–ª—é–∑–∞

&emsp; –î–ª—è –∑–∞–ø—É—Å–∫–∞ —à–ª—é–∑–∞ –Ω—É–∂–Ω–æ [–∑–∞–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞—Ç—å ESP32](https://www.youtube.com/watch?v=Vy-YTSdwy7s). –î–ª—è –ø—Ä–æ—à–∏–≤–∫–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É [flash_download_tools](https://www.espressif.com/en/support/download/other-tools). –§–∞–π–ª [**fr4sGate.bin**](https://github.com/alutov/ESP32-R4sGate-for-Redmond/raw/master/build/fr4sGate.bin) –≤ –ø–∞–ø–∫–µ build —ç—Ç–æ —É–∂–µ —Å–æ–±—Ä–∞–Ω–Ω—ã–π –±–∏–Ω–∞—Ä–Ω–∏–∫ –¥–ª—è esp32 @160MHz —Å –ø–∞–º—è—Ç—å—é 4 –ú–±–∞–π—Ç, DIO –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–º –∏ –ø—Ä–æ—à–∏–≤–∞–µ—Ç—Å—è –æ–¥–Ω–∏–º —Ñ–∞–π–ª–æ–º —Å –∞–¥—Ä–µ—Å–∞ **0x0000** –≤ —Ä–µ–∂–∏–º–µ **DIO**.  –ï—Å–ª–∏ –∂–µ DIO –∑–∞–≥—Ä—É–∑—á–∏–∫ –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∞–π–ª [**fqr4sGate.bin**](https://github.com/alutov/ESP32-R4sGate-for-Redmond/raw/master/build/fqr4sGate.bin) —Å –∑–∞–≥—Ä—É–∑—á–∏–∫–æ–º QIO –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ –≤ —Ä–µ–∂–∏–º–µ **QIO**. –ö–∞–∫ —è –ø–æ–Ω—è–ª, –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ esp32 –º–æ–∂–Ω–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞—Ç—å –≤ –ª—é–±–æ–º —Ä–µ–∂–∏–º–µ, –Ω–æ –±—ã–ª–∏ —Å–ª—É—á–∞–∏, —á—Ç–æ —à–ª—é–∑ —Ä–∞–±–æ—Ç–∞–ª —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø—Ä–æ—à–∏–≤–∫–µ –µ–≥–æ —Ñ–∞–π–ª–æ–º **fqr4sGate.bin** –≤ —Ä–µ–∂–∏–º–µ **QIO**. –§–∞–π–ª [**r4sGate.bin**](https://github.com/alutov/ESP32-R4sGate-for-Redmond/raw/master/build/r4sGate.bin) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—à–∏–≤–∫–∏ —á–µ—Ä–µ–∑ web –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å. –§–∞–π–ª—ã –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è ESP32C3 –≤ –ø–∞–ø–∫–µ C3.<br>
&emsp; –ó–∞—Ç–µ–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ç–æ—á–∫—É –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–µ —Å ssid **r4s** –∏ –ø–∞—Ä–æ–ª–µ–º **12345678**, –ø–æ–¥–æ–∂–¥–∞—Ç—å, –ø–æ–∫–∞ esp32 –Ω–µ –ø–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ –Ω–µ–º—É, –Ω–∞–π—Ç–∏ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö —Ç–æ—á–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ **r4s0Gate** –∏ –µ–≥–æ IP, –≤–≤–µ—Å—Ç–∏ —ç—Ç–æ—Ç –∞–¥—Ä–µ—Å –≤ –≤–µ–±-–±—Ä–∞—É–∑–µ—Ä–µ –∏ –¥–∞–ª–µ–µ –≤ web –≤–æ –≤–∫–ª–∞–¥–∫–µ Setting —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã. –ü–æ—Å–ª–µ —á–µ–≥–æ —Ç–æ—á–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–∞. Esp32 –±—É–¥–µ—Ç –ø—ã—Ç–∞—Ç—å—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ç–∏ **r4s** —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ç–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–∞—Ä–æ–ª–µ. –ï—Å–ª–∏ –Ω–µ —É–¥–∞–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∏ –∫ –≥–æ—Å—Ç–µ–≤–æ–π —Å–µ—Ç–∏, esp32 –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è. –í–∞—Ä–∏–∞–Ω—Ç —Å –≥–æ—Å—Ç–µ–≤–æ–π —Å–µ—Ç—å—é –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –æ–±—â–µ–ø—Ä–∏–Ω—è—Ç–æ–π –ø—Ä–∞–∫—Ç–∏–∫–∏ –∑–∞–ø—É—Å–∫–∞ —Ç–æ—á–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ esp32, –∫–∞–∫ –º–Ω–µ –∫–∞–∂–µ—Ç—Å—è, —É–¥–æ–±–Ω–µ–µ, —Ç–∞–∫ –∫–∞–∫ –≤ —Å–ª—É—á–∞–µ –ø–∞–¥–µ–Ω–∏—è –ø–æ –∫–∞–∫–∏–º-—Ç–æ –ø—Ä–∏—á–∏–Ω–∞–º Wi-Fi —Ä–æ—É—Ç–µ—Ä–∞ (–∞ –æ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–º —Ç–æ–ª—å–∫–æ –¥–ª—è iot —É—Å—Ç—Ä–æ–π—Å—Ç–≤) –æ—Å—Ç–∞–ª—å–Ω–æ–π Wi-Fi –Ω–µ –∑–∞—Å–æ—Ä—è–µ—Ç—Å—è –¥—Ä—É–∂–Ω–æ –≤–ø–ª—ã–≤—à–∏–º–∏ esp32.<br>
&emsp; –î–∞–ª–µ–µ –Ω—É–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ –∏–º—è –∏–ª–∏  MAC –∞–¥—Ä–µ—Å Redmond —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ –ø—Ä–∏–≤—è–∑–∞—Ç—å –µ–≥–æ –∫ —à–ª—é–∑—É. –ü–æ–∏—Å–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ, –Ω–æ –Ω–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, –ª–∏–±–æ –∞–∫—Ç–∏–≤–µ–Ω BLE –º–æ–Ω–∏—Ç–æ—Ä. –ï—Å–ª–∏ –∏–º—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–æ—á–Ω–æ –Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ (–∞ —Ä–µ–¥–º–æ–Ω–¥—ã –Ω–µ –≤—Å–µ–≥–¥–∞ —Å–≤–µ—Ç—è—Ç—Å—è –ø–æ BLE –∫–∞–∫ –º–æ–¥–µ–ª—å –æ–¥–∏–Ω –≤ –æ–¥–∏–Ω), —Ç–æ –¥–ª—è –Ω–∞—á–∞–ª–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω—É–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ –≤ –ø–æ–ª–µ **Name** –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ª—é–±–æ–µ –∏–º—è, –∞ –ø–æ—Ç–æ–º –∑–∞–º–µ–Ω–∏—Ç—å –µ–≥–æ –Ω–∞–π–¥–µ–Ω–Ω—ã–º –ø—Ä–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏ –≤—ã–±—Ä–∞—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±–ª–∏–∂–∞–π—à–∏–π —Ç–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–ø–æ–ª–µ **TYPE**, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è —á–∞–π–Ω–∏–∫–æ–≤ –æ—Ç RK-G(M)200S –¥–æ RK-G(M)240S  –ø—Ä–æ—Ç–æ–∫–æ–ª –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ, –º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –∫–∞–∫ RK-G200S, —Ç–∞–∫ –∏ RK-G240S). –ù—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å, —á—Ç–æ –Ω–µ –≤—Å–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–µ—Ä–µ–¥–∞—é—Ç –∏–º—è –ø—Ä–∏ –ø–∞—Å—Å–∏–≤–Ω–æ–º —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Xiaomi Mikettle, AM43 Blinds). –í –ª—é–±–æ–º —Å–ª—É—á–∞–µ –ª—É—á—à–µ –≤–≤–æ–¥–∏—Ç—å –≤ –ø–æ–ª–µ –∏–º–µ–Ω–∏ MAC –∞–¥—Ä–µ—Å, –º–æ–∂–Ω–æ –∫–∞–∫ —Å –¥–≤–æ–µ—Ç–æ—á–∏—è–º–∏, —Ç–∞–∫ –∏ –±–µ–∑. –ù–∞–π—Ç–∏ –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∞–¥—Ä–µ—Å –º–æ–∂–Ω–æ **BLE Last found name/address** –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—á–∫–µ –∏–ª–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ BLE monitor. –î–∞–ª–µ–µ –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ –Ω—É–∂–Ω–æ –Ω–∞–∂–∞—Ç—å –∏ —É–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∫–Ω–æ–ø–∫—É **+** –Ω–∞ —á–∞–π–Ω–∏–∫–µ –∏–ª–∏ **—Ç–∞–π–º–µ—Ä** –Ω–∞ –º—É–ª—å—Ç–∏–≤–∞—Ä–∫–µ  –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –≤–æ–π–¥–µ—Ç –≤ —Ä–µ–∂–∏–º –ø—Ä–∏–≤—è–∑–∫–∏ –∏ —á–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è —Å–æ–µ–¥–∏–Ω–∏—Ç—Å—è —Å–æ —à–ª—é–∑–æ–º. –ñ–∞–ª—é–∑–∏ AM43 —Ç—Ä–µ–±—É—é—Ç –µ—â–µ –∏ –≤–≤–æ–¥–∞ –ø–∏–Ω –∫–æ–¥–∞ (Passkey) –¥–ª—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.<br> 
&emsp; –ü—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –æ–¥–Ω–æ–º—É MQTT —Å–µ—Ä–≤–µ—Ä—É –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —à–ª—é–∑–æ–≤. –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –≤ –∫–∞–∂–¥–æ–º —à–ª—é–∑–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–≤–æ–π r4sGate Number. –®–ª—é–∑ —Å –Ω–æ–º–µ—Ä–æ–º 0 –±—É–¥–µ—Ç –ø–∏—Å–∞—Ç—å –≤ —Ç–æ–ø–∏–∫ r4s0/devaddr/..., —à–ª—é–∑ —Å –Ω–æ–º–µ—Ä–æ–º 1 - r4s1/devaddr/... –∏ —Ç.–¥. –ù—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ —É—á–µ—Å—Ç—å, —á—Ç–æ –∑–∞–ø—Ä–æ—Å –Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø—Ä–∏ –ø—Ä–∏–≤—è–∑–∫–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–æ–º–µ—Ä–∞ —à–ª—é–∑–∞ –∏ –æ—Ç –Ω–æ–º–µ—Ä–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –≤ —à–ª—é–∑–µ. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–≤—è–∑–∞—Ç—å 2 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —á–∞–π–Ω–∏–∫–∞ –∏–ª–∏ –º—É–ª—å—Ç–∏–≤–∞—Ä–∫–∏ –∫ 2 —Ä–∞–∑–Ω—ã–º —à–ª—é–∑–∞–º –∏–ª–∏ –∫ 2 —Ä–∞–∑–Ω—ã–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –æ–¥–Ω–æ–≥–æ —à–ª—é–∑–∞. –ï—Å–ª–∏ –∂–µ —Ä—è–¥–æ–º —Ä–∞–±–æ—Ç–∞—é—Ç –¥–≤–∞ —à–ª—é–∑–∞ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏, –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ –∫ —Ä–∞–∑–Ω—ã–º —Å–∏—Å—Ç–µ–º–∞–º —É–º–Ω–æ–≥–æ –¥–æ–º–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–æ—Å–µ–¥ –∑–∞ —Å—Ç–µ–Ω–∫–æ–π), –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∫ —à–ª—é–∑—É —Å–æ—Å–µ–¥–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø—Ü–∏—é –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º MAC –∞–¥—Ä–µ—Å–∞ —à–ª—é–∑–∞, –≤—ã–±—Ä–∞–≤ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö **Use MAC in BLE Authentication**. –ü–æ—Å–ª–µ —á–µ–≥–æ —Å–±—Ä–æ—Å–∏—Ç—å –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –≤—Å–µ –ø—Ä–∏–≤—è–∑–∫–∏ –∏ –∑–∞—Ç–µ–º –ø—Ä–∏–≤—è–∑–∞—Ç—å –∏—Ö –∫ —à–ª—é–∑—É –∑–∞–Ω–æ–≤–æ.<br>&emsp; –î–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Mqtt –±—Ä–æ–∫–µ—Ä—É –Ω—É–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ –µ–≥–æ –∞–¥—Ä–µ—Å –∏ –ø–æ—Ä—Ç, –∞ —Ç–∞–∫–∂–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å. –ï—Å–ª–∏ —à–ª—é–∑ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å Home Assistant –≤ –ø–∞—Ä–µ —Å mosquitto –±—Ä–æ–∫–µ—Ä–æ–º, —Å—Ç–æ–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø—Ü–∏—é Hass Discovery. –ü–µ—Ä–µ–¥ –µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥—É—é —É–¥–∞–ª–∏—Ç—å –≤ Mqtt –±—Ä–æ–∫–µ—Ä–µ –≤—Å–µ —Ç–æ–ø–∏–∫–∏ —Å r4s, –¥–ª—è —á–µ–≥–æ –≤—ã–±—Ä–∞—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö **Delete Mqtt topics**. –ï—Å–ª–∏ –∂–µ —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Mqtt Discovery, –ø—Ä–∏–¥–µ—Ç—Å—è —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è —Å Mqtt.  
<details>
<summary>–ü–æ–¥—Ä–æ–±–Ω–µ–µ –ø–æ Mqtt...</summary>
     –£ –º–µ–Ω—è —à–ª—é–∑ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ ioBroker. –ú–æ–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ MQTT –±—Ä–æ–∫–µ—Ä–∞ –Ω–∏–∂–µ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ 3.<br>

![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/mymqtt.jpg)
–ö–∞—Ä—Ç–∏–Ω–∫–∞ 3. –ú–æ–∏ Mqtt –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.<br><br>
     
&emsp; –°–Ω—è—Ç —Ñ–ª–∞–≥ retain, —á—Ç–æ–±—ã –±—Ä–æ–∫–µ—Ä –Ω–µ –∑–∞–ø–æ–º–∏–Ω–∞–ª, –∞ —Å—á–∏—Ç—ã–≤–∞–ª —Å–æ—Å—Ç–æ—è–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø—Ä–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏. –í Home Assistant  —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –≤ –Ω–µ–º –∏/–∏–ª–∏ Mqtt –±—Ä–æ–∫–µ—Ä–µ —Ñ–ª–∞–≥ retain [–º–æ–∂–µ—Ç –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ —Å–∞–º–æ–ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–º—É –≤–∫–ª—é—á–µ–Ω–∏—é –∏ –≤—ã–∫–ª—é—á–µ–Ω–∏—é —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞](https://mjdm.ru/forum/viewtopic.php?f=8&t=5501&sid=de6b1e2b43f25c8d9ae9af5673ee9417&start=140#p121604).  –¢–∞–∫–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Ñ–ª–∞–≥ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∫–µ, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–µ –≤–≤–æ–¥–∏—Ç—å –≤—Å–µ —Ç–æ–ø–∏–∫–∏ –≤—Ä—É—á–Ω—É—é. –ò–Ω–æ–≥–¥–∞ –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å—Ä–∞–∑—É –±–æ–ª—å—à–æ–≥–æ —á–∏—Å–ª–∞ –ø–æ–¥–ø–∏—Å–æ–∫ ioBroker –ø–æ—á–µ–º—É-—Ç–æ –¥–µ–ª–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –Ω–∏—Ö —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –∑–∞–ø–∏—Å–∏ :-), –µ—Å—Ç—å —É –º–µ–Ω—è —Ç–∞–∫–æ–π –≥–ª—é–∫. –ü—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –∏—Ö —É–¥–∞–ª—è—Ç—å –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å Mqtt –∞–¥–∞–ø—Ç–µ—Ä, —á—Ç–æ–±—ã –æ–Ω–∏ –ø–æ—è–≤–∏–ª–∏—Å—å –æ–ø—è—Ç—å.<br>

#### Mqtt —Ç–æ–ø–∏–∫–∏ –¥–ª—è —á–∞–π–Ω–∏–∫–∞ (—Å–º. –∫–∞—Ä—Ç–∏–Ω–∫—É 4 –Ω–∏–∂–µ):

`r4s0/devaddr/cmd/boil` <-- `0/off/false` - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ –∫–∏–ø—è—á–µ–Ω–∏—è, `1/on/true` - –≤–∫–ª—é—á–µ–Ω–∏–µ –∫–∏–ø—è—á–µ–Ω–∏—è. –ï—Å–ª–∏ –ø–µ—Ä–µ–¥ —ç—Ç–∏–º –±—ã–ª –≤–∫–ª—é—á–µ–Ω –ø–æ–¥–æ–≥—Ä–µ–≤, –≤–∫–ª—é—á–∞–µ—Ç—Å—è –∫–∏–ø—è—á–µ–Ω–∏–µ —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º –ø–æ–¥–æ–≥—Ä–µ–≤–æ–º;<br>
`r4s0/devaddr/cmd/heat` <-- `0/off/false` - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–¥–æ–≥—Ä–µ–≤–∞, `1/on/true` - –≤–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–¥–æ–≥—Ä–µ–≤–∞ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–ø–æ–º–Ω–µ–Ω–Ω–æ–π —à–ª—é–∑–æ–º —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–æ–π. –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —à–ª—é–∑–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –±–µ—Ä–µ—Ç—Å—è –∏–∑ –ø–æ–ª—è Heat –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö;<br>
`r4s0/devaddr/cmd/heat_temp` <-- `30...90` - –≤–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–¥–æ–≥—Ä–µ–≤–∞, `> 97` - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ, `< 30` - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ, –µ—Å–ª–∏ –ø–æ–¥–æ–≥—Ä–µ–≤ –±—ã–ª –≤–∫–ª—é—á–µ–Ω, –ø–æ—Å–ª–µ–¥–Ω—è—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –µ—Å–ª–∏ –±—ã–ª –≤—ã–∫–ª—é—á–µ–Ω;<br>
`r4s0/devaddr/cmd/boiltime` <-- `-5...5` - –≤—Ä–µ–º—è –∫–∏–ø–µ–Ω–∏—è —á–∞–π–Ω–∏–∫–∞;<br>
`r4s0/devaddr/cmd/nightlight` <-- `0/off/false` - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ –Ω–æ—á–Ω–∏–∫–∞, `1/on/true` - –≤–∫–ª—é—á–µ–Ω–∏–µ –Ω–æ—á–Ω–∏–∫–∞;<br>
`r4s0/devaddr/cmd/nightlight_red` <-- `0..255` –£—Ä–æ–≤–µ–Ω—å –∫—Ä–∞—Å–Ω–æ–≥–æ –≤ –Ω–æ—á–Ω–∏–∫–µ;<br>
`r4s0/devaddr/cmd/nightlight_green` <-- `0..255` –£—Ä–æ–≤–µ–Ω—å –∑–µ–ª–µ–Ω–æ–≥–æ –≤ –Ω–æ—á–Ω–∏–∫–µ;<br>
`r4s0/devaddr/cmd/nightlight_blue` <-- `0..255` –£—Ä–æ–≤–µ–Ω—å —Å–∏–Ω–µ–≥–æ –≤ –Ω–æ—á–Ω–∏–∫–µ;<br>
`r4s0/devaddr/rsp/` - —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, rssi –∏ —Ç.–¥.;<br>

> –ó–Ω–∞—á–µ–Ω–∏—è —É—Ä–æ–≤–Ω–µ–π –∑–∞–ø–æ–º–∏–Ω–∞—é—Ç—Å—è –≤ —à–ª—é–∑–µ –∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –Ω–∞ —á–∞–π–Ω–∏–∫ –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –ø–æ–¥—Å–≤–µ—Ç–∫–∏.
<br>

![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/mymqtt1.jpg)
–ö–∞—Ä—Ç–∏–Ω–∫–∞ 4. –ú–æ–∏ Mqtt —Ç–æ–ø–∏–∫–∏ –¥–ª—è —á–∞–π–Ω–∏–∫–∞.

#### Mqtt —Ç–æ–ø–∏–∫–∏ –¥–ª—è –º—É–ª—å—Ç–∏–≤–∞—Ä–∫–∏ (—Å–º. –∫–∞—Ä—Ç–∏–Ω–∫—É 5 –Ω–∏–∂–µ):

`r4s0/devaddr/cmd/state` <-- `0/off/false` - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ, `1/on/true` - —Å—Ç–∞—Ä—Ç –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏–ª–∏ –ø–æ–¥–æ–≥—Ä–µ–≤, –µ—Å–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞;<br> 
`r4s0/devaddr/cmd/prog` <-- –Ω–æ–º–µ—Ä –ø—Ä–æ–≥—Ä–∞–º–º—ã 1-12, 0 - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ;<br>
     –ü—Ä–æ–≥—Ä–∞–º–º—ã:<br>
     1 - Rice / –†–∏—Å –ö—Ä—É–ø—ã, 2 - Slow Cooking / –¢–æ–º–ª–µ–Ω–∏–µ, 3 - Pilaf / –ü–ª–æ–≤, 4 - Frying / –ñ–∞—Ä–∫–∞;<br>
     5 - Stewing / –¢—É—à–µ–Ω–∏–µ, 6 - Pasta / –ü–∞—Å—Ç–∞, 7 - Milk Porridge / –ú–æ–ª–æ—á–Ω–∞—è –∫–∞—à–∞, 8 - Soup / –°—É–ø;<br>
     9 - Yogurt / –ô–æ–≥—É—Ä—Ç, 10 - Baking / –í—ã–ø–µ—á–∫–∞, 11 - Steam / –ü–∞—Ä, 12 - Hot / –í–∞—Ä–∫–∞ –ë–æ–±–æ–≤—ã–µ;<br>
`r4s0/devaddr/cmd/mode` <-- —Ä–µ–∂–∏–º: 1 - –æ–≤–æ—â–∏, 2 - —Ä—ã–±–∞, 3 - –º—è—Å–æ –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º 4,5,11<br>
`r4s0/devaddr/cmd/temp` <-- —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞;<br>
`r4s0/devaddr/cmd/set_hour` <-- –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã, —á–∞—Å—ã;<br>
`r4s0/devaddr/cmd/set_min` <-- –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã, –º–∏–Ω—É—Ç—ã;<br>
`r4s0/devaddr/cmd/delay_hour` <-- –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–ª—é—Å –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–æ —Å—Ç–∞—Ä—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã, —á–∞—Å—ã;<br>
`r4s0/devaddr/cmd/delay_min` <-- –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–ª—é—Å –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–æ —Å—Ç–∞—Ä—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –º–∏–Ω—É—Ç—ã;<br>
`r4s0/devaddr/cmd/warm` <-- –ø–æ–¥–æ–≥—Ä–µ–≤ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã;<br>

> –ü–∞—Ä–∞–º–µ—Ç—Ä—ã `delay_hour` –∏ `delay_min` –∑–∞–ø–æ–º–∏–Ω–∞—é—Ç—Å—è –≤ —à–ª—é–∑–µ –∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã, —Ä–µ–∂–∏–º–∞ –∏–ª–∏ –ø–æ–¥–æ–≥—Ä–µ–≤–∞, –∞ –ø–æ—Ç–æ–º—É —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –ø–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã, —Ä–µ–∂–∏–º–∞ –∏–ª–∏ –∞–≤—Ç–æ–ø–æ–¥–æ–≥—Ä–µ–≤–∞. –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∏ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ mode –µ—â–µ —Ä–∞–∑ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É—é—Ç—Å—è. –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ —Ä–µ–∂–∏–º–∞ –º–æ–∂–Ω–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è –∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É. –≠—Ç–æ—Ç –ø–æ—Ä—è–¥–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ–±—É—Å–ª–æ–≤–ª–µ–Ω —Ç–µ–º, —á—Ç–æ –ø–æ Mqtt –Ω–µ–ª—å–∑—è —Å—Ä–∞–∑—É —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö —Ç–æ–ø–∏–∫–∞—Ö. –ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∂–µ —á–µ—Ä–µ–∑ web –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç–∞–≤—è—Ç—Å—è –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π. –ò –∑–Ω–∞—á–µ–Ω–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏ —Ä–µ–∂–∏–º–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ web —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–µ—Ä–µ–¥ —ç—Ç–∏–º –æ–Ω–∏ –±—ã–ª–∏  —Ä–∞–≤–Ω—ã 0. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –º—É–ª—å—Ç–∏–ø–æ–≤–∞—Ä –ø–æ–∫–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è, —è –Ω–µ –≤–∏–∂—É —Å–º—ã—Å–ª–∞. –ü—Ä–∏ –∑–∞–ø–∏—Å–∏ –Ω—É–ª—è –≤ prog –Ω–∞ –º—É–ª—å—Ç–∏–≤–∞—Ä–∫—É –ø–æ—Å—ã–ª–∞–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞ –≤—ã–∫–ª—é—á–µ–Ω–∏—è, —á—Ç–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è —Å–±—Ä–æ—Å–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã.
<br>

![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/mymqtt2.jpg)
 –ö–∞—Ä—Ç–∏–Ω–∫–∞ 5. –ú–æ–∏ Mqtt —Ç–æ–ø–∏–∫–∏ –¥–ª—è –º—É–ª—å—Ç–∏–≤–∞—Ä–∫–∏.

#### Mqtt —Ç–æ–ø–∏–∫–∏ –¥–ª—è –∫–æ—Ñ–µ–≤–∞—Ä–∫–∏:

`r4s0/devaddr/cmd/state` <-- `0/off/false` - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ, `1/on/true` - –≤–∫–ª—é—á–µ–Ω–∏–µ;<br>
`r4s0/devaddr/cmd/delay_hour` <-- –≤—Ä–µ–º—è –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞, —á–∞—Å—ã;<br>
`r4s0/devaddr/cmd/delay_min` <-- –≤—Ä–µ–º—è –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞, –º–∏–Ω—É—Ç—ã;<br>
`r4s0/devaddr/cmd/delay` <-- –∑–∞–ø—É—Å–∫ –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞, `0/off/false` - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ, `1/on/true` - –≤–∫–ª—é—á–µ–Ω–∏–µ;<br>
`r4s0/devaddr/cmd/lock` <-- –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞, `0/off/false` - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ, `1/on/true` - –≤–∫–ª—é—á–µ–Ω–∏–µ;<br>
`r4s0/devaddr/cmd/strength` <-- –∫—Ä–µ–ø–æ—Å—Ç—å, `0/off/false` - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ, `1/on/true` - –≤–∫–ª—é—á–µ–Ω–∏–µ;<br>
`r4s0/devaddr/rsp/` - —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, rssi –∏ —Ç.–¥.;<br>

> –ó–Ω–∞—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞ –∑–∞–ø–æ–º–∏–Ω–∞—é—Ç—Å—è –≤ —à–ª—é–∑–µ –∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –Ω–∞ –∫–æ—Ñ–µ–≤–∞—Ä–∫—É –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ —ç—Ç–æ–≥–æ —Ä–µ–∂–∏–º–∞.

#### Mqtt —Ç–æ–ø–∏–∫–∏ –¥–ª—è —Ä–æ–∑–µ—Ç–∫–∏:

`r4s0/devaddr/cmd/state` <-- `0/off/false` - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ, `1/on/true` - –≤–∫–ª—é—á–µ–Ω–∏–µ;<br>
`r4s0/devaddr/cmd/lock` <-- –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞, `0/off/false` - –≤—ã–∫–ª—é—á–µ–Ω–∏–µ, `1/on/true` - –≤–∫–ª—é—á–µ–Ω–∏–µ;<br>
`r4s0/devaddr/rsp/` - —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, rssi –∏ —Ç.–¥.;

&emsp; –ù–∞—á–∏–Ω–∞—è —Å –≤–µ—Ä—Å–∏–∏ 2020.10.27 –ø–æ—è–≤–∏–ª–∞—Å—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–≤–º–µ—â–µ–Ω–Ω—ã–µ —Ç–æ–ø–∏–∫–∏ –¥–ª—è –∫–æ–º–∞–Ω–¥ –∏ –æ—Ç–≤–µ—Ç–æ–≤. –û–ø—Ü–∏—è –≤–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö. –ú–Ω–µ —ç—Ç–æ –ø—Ä–∏–≥–æ–¥–∏–ª–æ—Å—å –ø—Ä–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ Google Home —Å –ø–æ–º–æ—â—å—é –¥—Ä–∞–π–≤–µ—Ä–∞ iot iobroker-–∞. –ö–∞–∫ —è –ø–æ–Ω—è–ª, —ç—Ç–æ—Ç –¥—Ä–∞–π–≤–µ—Ä –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–∞–∑–¥–µ–ª—å–Ω—ã–µ —Ç–æ–ø–∏–∫–∏ –∫–æ–º–∞–Ω–¥/–æ—Ç–≤–µ—Ç–æ–≤. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, —Ç–∞–∫ –∫–∞–∫ Google Home –ø–æ–Ω–∏–º–∞–µ—Ç `true / false` –≤–º–µ—Å—Ç–æ `ON / OFF`, —Ç–æ –Ω—É–∂–Ω–æ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –¥—Ä–∞–π–≤–µ—Ä–∞ iot `Conversation to Google Home = function (value) {}` –≤–≤–µ—Å—Ç–∏ —Å—Ç—Ä–æ–∫—É –≤–∏–¥–∞ `switch (value) {case **ON**: return true ; break; default: return false;}`. –ï—Å–ª–∏ –∂–µ –∞–≤—Ç–æ–∑–∞–º–µ–Ω–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, —Ç–æ –Ω–∞—á–∏–Ω–∞—è —Å –≤–µ—Ä—Å–∏–∏ 2020.11.07 –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø—Ü–∏—é `**true / false** Response`. –û–ø—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ–≤–º–µ—Å—Ç–Ω–æ —Å Hass Discovery, —Ç–∞–º –æ–Ω–∞ –Ω–µ –Ω—É–∂–Ω–∞.<br>
</details>

#### –í–µ–± –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ –º–æ–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å —Ç–∞–∫–∂–µ –∏ –≤ –≤–µ–± –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ —à–ª—é–∑–∞. –ü—Ä–∏–º–µ—Ä—ã –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–∞—Å—Ç—Ä–æ–µ–∫ –Ω–∏–∂–µ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∞—Ö 6 –∏ 7.

![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/myweb.jpg) 
–ö–∞—Ä—Ç–∏–Ω–∫–∞ 6. –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—á–∫–∞.

![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/myweb1.jpg) 
–ö–∞—Ä—Ç–∏–Ω–∫–∞ 7. –°—Ç—Ä–∞–Ω–∏—á–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫.
 
## 4. BLE Monitor
&emsp;–ú–æ–Ω–∏—Ç–æ—Ä –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –º–µ—Ç–∫–∏(–º–∞—è–∫–∏) —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ MAC –∞–¥—Ä–µ—Å–∞–º–∏. –í—ã–≤–æ–¥–∏—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ/–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–µ—Ç–∫–∏(–º–∞—è–∫–∞) –∏ rssi.<br>
**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è:**
* BLE –º–∞—è–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Home Assistant –Ω–∞ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–∞—Ö (–ø—Ä–∏–≤—è–∑–∫–∞ –ø–æ uuid, —Ç–∞–π–º-–∞—É—Ç —É –º–µ–Ω—è 60 —Å–µ–∫—É–Ω–¥)
* –¢–µ—Ä–º–æ–º–µ—Ç—Ä—ã Xiaomi LYWSD03MMC —Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π –ø—Ä–æ—à–∏–≤–∫–æ–π, [–ø—Ä–æ—à–∏–≤–∫–æ–π –æ—Ç atc1441 –≤ —Ä–µ–∂–∏–º–µ custom](https://github.com/atc1441/ATC_MiThermometer) –∏ [–ø—Ä–æ—à–∏–≤–∫–æ–π –æ—Ç pvvx –≤ —Ä–µ–∂–∏–º–µ custom –∏ Mija](https://github.com/pvvx/ATC_MiThermometer). –ö–ª—é—á–∏ –¥–ª—è LYWSD03MMC –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –º–æ–∂–Ω–æ –≤–∑—è—Ç—å –∏–∑ [–æ–±–ª–∞–∫–∞ Xiaomi](https://github.com/PiotrMachowski/Xiaomi-cloud-tokens-extractor?tab=readme-ov-file). (400 —Å–µ–∫—É–Ω–¥)
* –¢–µ—Ä–º–æ–º–µ—Ç—Ä—ã Xiaomi LYWSDCGQ (400 —Å–µ–∫—É–Ω–¥)
* –ß–∞—Å—ã —Å —Ç–µ—Ä–º–æ–º–µ—Ç—Ä–æ–º Xiaomi LYWSD02 (400 —Å–µ–∫—É–Ω–¥) 
* –í–µ—Å—ã Xiaomi Mi Scale  (400 —Å–µ–∫—É–Ω–¥)
* Qingping Air Monitor Lite(CGDN1) (400 —Å–µ–∫—É–Ω–¥)
* –°—á–µ—Ç—á–∏–∫–∏ –≤–æ–¥—ã –∏ –≥–∞–∑–∞ Elehant  (400 —Å–µ–∫—É–Ω–¥)
* Samsung Smart Tag (120 —Å–µ–∫—É–Ω–¥).
     
&emsp;–î–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –º–æ–Ω–∏—Ç–æ—Ä–∞ –Ω—É–∂–Ω–æ –≤–æ –≤–∫–ª–∞–¥–∫–µ **Setting** —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ –æ–ø—Ü–∏–∏ **BLE Monitoring** –∑–Ω–∞—á–µ–Ω–∏—è **Active** –∏–ª–∏ **Passive** –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∏–ª–∏ –ø–∞—Å—Å–∏–≤–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –Ω–∞–∂–∞—Ç—å **Save setting**. –ê–∫—Ç–∏–≤–Ω—ã–π —Å–∫–∞–Ω–µ—Ä –¥–∞–µ—Ç –±–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –Ω–æ —Ä–∞—Å—Ö–æ–¥—É–µ—Ç –±–æ–ª—å—à–µ —ç–Ω–µ—Ä–≥–∏–∏ –Ω–∞ —Å–∫–∞–Ω–∏—Ä—É–µ–º—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö. –î–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –º–µ—Ç–æ–∫ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–∞—Å—Å–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º. –ù—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å, —á—Ç–æ –≤ —Ä–µ–∂–∏–º–µ **Auto** –ø—Ä–∏ –ø–æ–∏—Å–∫–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø–µ—Ä–µ–¥ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º —Å–∫–∞–Ω–µ—Ä –≤—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ, –∞ –ø–æ—Ç–æ–º –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ –ø–∞—Å—Å–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º.<br> 
&emsp; –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –æ–ø—Ü–∏–∏ –≤ –º–µ–Ω—é –ø–æ—è–≤–∏—Ç—Å—è –≤–∫–ª–∞–¥–∫–∞ **BLE Monitor**, –æ—Ç–∫—Ä—ã–≤ –∫–æ—Ç–æ—Ä—É—é, –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞. –í –ø–æ–ª–µ **Gap** –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –¥–≤—É–º—è –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ –ø—Ä–∏—à–µ–¥—à–∏–º–∏ –ø–∞–∫–µ—Ç–∞–º–∏, –≤ –ø–æ–ª–µ **Last** –≤—Ä–µ–º—è —Å –º–æ–º–µ–Ω—Ç–∞ –ø—Ä–∏—Ö–æ–¥–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–∞–∫–µ—Ç–∞. –¢–∞–π–º-–∞—É—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–µ—Å–ª–∏ –≤ –ø–æ–ª–µ **Timeout** –ø—É—Å—Ç–æ) 300 —Å–µ–∫—É–Ω–¥, –ø–æ—Å–ª–µ —á–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã–º, –∞ –µ–≥–æ –¥–∞–Ω–Ω—ã–µ —É–¥–∞–ª—è—é—Ç—Å—è –∏–∑ —Ç–∞–±–ª–∏—Ü—ã. –í –¥–∞–ª—å–Ω–µ–π—à–µ–º —ç—Ç–∞ —Å—Ç—Ä–æ–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω–∞ –¥–∞–Ω–Ω—ã–º–∏ —Å –¥—Ä—É–≥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞. **–î–ª—è –≤—ã–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Mqtt –≤ –ø–æ–ª–µ Timeout –Ω—É–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ –Ω–µ–Ω—É–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –≤–≤–æ–¥, –Ω–∞–∂–∞–≤ Ok**. –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —ç–Ω–µ—Ä–≥–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–π –ø–∞–º—è—Ç–∏, –∞ Mqtt Discovery –ø–µ—Ä–µ–¥–∞—Å—Ç –≤—Å–µ –≤ Home Assistant. –•–æ—Ç—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–¥–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ, –Ω–æ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∑–Ω–∞—á–µ–Ω–∏—è **Timeout** –Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å, —á—Ç–æ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —Ç–æ–∂–µ –Ω—É–∂–Ω–æ –≤—Ä–µ–º—è, –≤ —Ç–µ—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –≤–æ–∑–º–æ–∂–Ω—ã –ø—Ä–æ–ø—É—Å–∫–∏ –ø–∞–∫–µ—Ç–æ–≤. –õ–∏—à–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ Mqtt –∏ Home Assistant –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å, –≤—ã–±—Ä–∞–≤ –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–Ω–æ–º BLE –º–æ–Ω–∏—Ç–æ—Ä–µ –≤–æ –≤–∫–ª–∞–¥–∫–µ **Setting** –æ–ø—Ü–∏—é **Delete Mqtt topics** –∏ –Ω–∞–∂–∞–≤ **Save setting**.<br>
&emsp;Samsung Smart Tag, –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –∫ –∞–∫–∫–∞—É–Ω—Ç—É SmartThings, –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –Ω–µ –ø—Ä–∏–≥–æ–¥–Ω—ã, —Ç–∞–∫ –∫–∞–∫ —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç –æ—Ç–∫–ª—é—á–∞—é—Ç—Å—è. –†–µ–∫–ª–∞–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω–æ–≥–æ –∫ –∞–∫–∫–∞—É–Ω—Ç—É Smart Tag —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π UUID 0xFD5A, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π MAC –∞–¥—Ä–µ—Å –∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä, –∏–∑-–∑–∞ –Ω–∞–ª–∏—á–∏—è –≤ –Ω–µ–º RND –±–∞–π—Ç –º–µ–Ω—è—é—â–∏–π—Å—è –≤–º–µ—Å—Ç–µ —Å MAC –∞–¥—Ä–µ—Å–æ–º. –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è (—Å—Ç–∞—Ç—É—Å, —Å—á–µ—Ç—á–∏–∫ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π, —Ä–µ–≥–∏–æ–Ω, —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–∞—Ç–∞—Ä–µ–∏) –Ω–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã. –†–µ–∫–ª–∞–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–∞–∫–∂–µ —Ü–∏—Ñ—Ä–æ–≤—É—é –ø–æ–¥–ø–∏—Å—å. –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ BLE —Ç—Ä–µ–∫–µ—Ä—ã, –Ω–∞—Å–∫–æ–ª—å–∫–æ –º–Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–æ, —Å–ø–æ—Å–æ–±–Ω—ã –æ–ø–æ–∑–Ω–∞—Ç—å –Ω–∞–ª–∏—á–∏–µ —ç—Ç–∏—Ö –º–µ—Ç–æ–∫ –ø–æ UUID, –Ω–æ –Ω–µ —Å–ø–æ—Å–æ–±–Ω—ã –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—É—é –º–µ—Ç–∫—É, –µ—Å–ª–∏ –∏—Ö –±–æ–ª—å—à–µ –æ–¥–Ω–æ–π. –®–ª—é–∑ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø–æ–¥–ø–∏—Å–∏ —Ä–µ–∫–ª–∞–º–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —ç—Ç–∏—Ö –º–µ—Ç–æ–∫(–º–∞—è–∫–æ–≤), —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –≤–≤–æ–¥–∞ –∫–ª—é—á–∞. –ü–æ—Å–ª–µ –≤–≤–æ–¥–∞ –∫–ª—é—á –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∏, –µ—Å–ª–∏ –≤—Å–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –Ω—É–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–∞–π–º-–∞—É—Ç–∞. –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞ —Ç–∞–π–º-–∞—É—Ç–∞ –∏ –Ω–∞–∂–∞—Ç–∏—è **Ok** –∫–ª—é—á –∏ —Ç–∞–π–º-–∞—É—Ç –∑–∞–ø–æ–º–∏–Ω–∞—é—Ç—Å—è –≤ NVS (Non-volatile storage - —ç–Ω–µ—Ä–≥–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º–∞—è –ø–∞–º—è—Ç—å).
<details>
<summary>–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –∫–ª—é—á...</summary>

&emsp; –ö–ª—é—á (Signing Key) –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π ASCII —Å—Ç—Ä–æ–∫—É –∏–∑ 64 —Å–∏–º–≤–æ–ª–æ–≤ (—ç—Ç–æ 32 –±–∞–π—Ç–∞ –≤ —à–µ—Å—Ç–Ω–∞–¥—Ü–∞—Ç–µ—Ä–∏—á–Ω–æ–º –≤–∏–¥–µ, 16 –±–∞–π—Ç –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è AES128CBC –∏ 16 –±–∞–π—Ç –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞).  –î–µ–π—Å—Ç–≤—É–µ—Ç –æ—Ç –º–æ–º–µ–Ω—Ç–∞ –ø—Ä–∏–≤—è–∑–∫–∏ Smart Tag –∫ –∞–∫–∫–∞—É–Ω—Ç—É SmartThings –∏ –¥–æ –º–æ–º–µ–Ω—Ç–∞ –æ—Ç–≤—è–∑–∫–∏ –æ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞ –∏–ª–∏ –≤–æ–∑–≤—Ä–∞—Ç–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∫ –∑–∞–≤–æ–¥—Å–∫–∏–º —É—Å—Ç–∞–Ω–æ–≤–∫–∞–º. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏ –º–µ—Ç–∫–æ–π Smart Tag,  –∏ —Å–µ—Ä–≤–µ—Ä–æ–º SmartThings, –ø–æ –∫–∞–Ω–∞–ª—É —Å–≤—è–∑–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è. –ü–µ—Ä–≤—ã–µ 16 –±–∞–π—Ç –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —à–ª—é–∑–æ–º –∫–∞–∫ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ —Å–∏—Å—Ç–µ–º–µ —É–º–Ω–æ–≥–æ –¥–æ–º–∞. –î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª—é—á–∞ –Ω—É–∂–Ω–æ –∑–∞–ø–∏—Å–∞—Ç—å –ª–æ–≥ Bluetooth HCI –≤ –º–æ–º–µ–Ω—Ç –ø—Ä–∏–≤—è–∑–∫–∏ Smart Tag –∫ –∞–∫–∫–∞—É–Ω—Ç—É SmartThings. –ï—Å–ª–∏ –º–µ—Ç–∫–∞ —É–∂–µ –ø—Ä–∏–≤—è–∑–∞–Ω–∞, –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é –ª–æ–≥–∞ –µ–µ –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞. –î–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –∞–∫–∫–∞—É–Ω—Ç—É –Ω—É–∂–Ω–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ Galaxy c –≤–µ—Ä—Å–∏–µ–π android –Ω–µ –Ω–∏–∂–µ 8.0. –Ø –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª Galaxy S7. –ü—Ä–µ–∂–¥–µ –≤—Å–µ–≥–æ –Ω—É–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞. –û—Ç–∫—Ä—ã–≤–∞–µ–º **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ > –°–≤–µ–¥–µ–Ω–∏—è –æ —Ç–µ–ª–µ—Ñ–æ–Ω–µ > –°–≤–µ–¥–µ–Ω–∏—è –æ –ü–û** –∏ 8 (–∫–∞–∂–µ—Ç—Å—è) —Ä–∞–∑ –Ω–∞–∂–∏–º–∞–µ–º –Ω–æ–º–µ—Ä —Å–±–æ—Ä–∫–∏. –ú–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –≤–≤–µ—Å—Ç–∏ –ø–∏–Ω –∫–æ–¥ —Ç–µ–ª–µ—Ñ–æ–Ω–∞. –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è –º–µ–Ω—é **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞**. –ó–∞—Ö–æ–¥–∏–º –≤ –º–µ–Ω—é –∏ –≤–∫–ª—é—á–∞–µ–º **–ñ—É—Ä–Ω–∞–ª –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è Bluetooth**. –î–∞–ª–µ–µ —è –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π –≤—ã–∫–ª—é—á–∞–ª –∏ –≤–∫–ª—é—á–∞–ª Bluetooth, –∑–∞—Ç–µ–º –ø–µ—Ä–µ–≥—Ä—É–∂–∞–ª —Ç–µ–ª–µ—Ñ–æ–Ω. –ó–∞—Ö–æ–¥–∏–º –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **SmartThings** –∏ –¥–æ–±–∞–≤–ª—è–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ **Smart Tag**. –ó–∞—Ç–µ–º –æ–ø—è—Ç—å –∏–¥–µ–º –≤ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ > –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞** –∏ –≤—ã–±–∏—Ä–∞–µ–º **–°–æ–∑–¥–∞—Ç—å –æ—Ç—á–µ—Ç –æ–± –æ—à–∏–±–∫–∞—Ö > –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –æ—Ç—á–µ—Ç**. –ß–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è –ø—Ä–∏–¥–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–æ–∑–¥–∞–Ω–Ω–æ–º –æ—Ç—á–µ—Ç–µ. –î–∞–ª–µ–µ –µ–≥–æ –Ω—É–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ —Å windows. –Ø –≤—ã–±–∏—Ä–∞–ª —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ telegram –≤ –ø–∞–ø–∫–µ **–ò–∑–±—Ä–∞–Ω–Ω–æ–µ**, –∞ –∑–∞—Ç–µ–º —É–∂–µ –≤ telegram –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª –∞—Ä—Ö–∏–≤. –ó–∞—Ç–µ–º –Ω—É–∂–Ω–æ –∏–∑–≤–ª–µ—á—å –∏–∑ –∞—Ä—Ö–∏–≤–∞ (–ø–∞–ø–∫–∞ **FS/data/log/bt/**) —Ñ–∞–π–ª—ã **btsnoop_hci.log** –∏ **btsnoop_hci.log.last**. –í –æ–¥–Ω–æ–º –∏–∑ —ç—Ç–∏—Ö —Ñ–∞–π–ª–æ–≤ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ª–æ–≥ –ø—Ä–∏–≤—è–∑–∫–∏. –î–∞–ª–µ–µ –≤ –ø–∞–ø–∫—É —Å —ç—Ç–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏ –∑–∞–≥—Ä—É–∂–∞–µ–º –∞—Ä—Ö–∏–≤ —Å [**–∫–æ–Ω—Å–æ–ª—å–Ω–æ–π —É—Ç–∏–ª–∏—Ç–æ–π stsk**](https://github.com/alutov/ESP32-R4sGate-for-Redmond/raw/master/utils/stsk.zip) –∏ –¥–æ—Å—Ç–∞–µ–º –ø—Ä–æ–≥—Ä–∞–º–º—É –∏–∑ –∞—Ä—Ö–∏–≤–∞. –ù–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π –æ—Ç–º–µ—á—É, —á—Ç–æ –≤–∏—Ä—É—Å–æ–≤ –≤ –∞—Ä—Ö–∏–≤–µ –Ω–µ—Ç, –∞ —Ä–∞–∑–º–µ—Ä –ø—Ä–æ–≥—Ä–∞–º–º—ã 28160 –±–∞–π—Ç. –û—Ç–∫—Ä—ã–≤–∞–µ–º –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É windows, –∑–∞—Ö–æ–¥–∏–º –≤ –ø–∞–ø–∫—É —Å —Ñ–∞–π–ª–∞–º–∏ –∏ –Ω–∞–±–∏—Ä–∞–µ–º **stsk btsnoop_hci.log** –∏ **stsk btsnoop_hci.log.last**. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –≤—ã–≤–µ–¥–µ—Ç –Ω–∞–π–¥–µ–Ω–Ω—ã–µ Smart Tag –∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–ª—é—á–∏ –¥–ª—è –Ω–∏—Ö. –ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–ª—é—á –±—É–¥–µ—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞ windows:<br>
     
![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/stsk.jpg) 
–ö–∞—Ä—Ç–∏–Ω–∫–∞ 8. –ü—Ä–æ–≥—Ä–∞–º–º–∞ stsk.

&emsp;  –ü—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–∞–∑–±–∏—Ç—ã–µ –Ω–∞ —á–∞—Å—Ç–∏ –ø–∞–∫–µ—Ç—ã –¥–∞–Ω–Ω—ã—Ö, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –µ—Å–ª–∏ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç —Ç–∞–∫–æ–π –ø–∞–∫–µ—Ç, —Ç–æ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –≤ –ª–æ–≥–µ –Ω–∏—á–µ–≥–æ –∏–ª–∏ –≤—ã–¥–∞–µ—Ç –æ—à–∏–±–∫—É. –°—Ç–æ–ª–∫–Ω—É–ª—Å—è —Å —ç—Ç–∏–º –ø–æ–∫–∞ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –Ω–∞ s21. –í–æ–∑–º–æ–∂–Ω–æ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Å–±–æ–π, —Ç.–∫ wireshark —Ç–æ–∂–µ –Ω–µ —Å–æ–≤—Å–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª —Å–±–æ–π–Ω—ã–π –ø–∞–∫–µ—Ç. –ò –ø–æ–∫–∞ –Ω–µ –Ω–∞—à–µ–ª –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –æ–ø–æ–∑–Ω–∞–Ω–∏—è –∏ —Å–±–æ—Ä–∫–∏ —Ç–∞–∫–∏—Ö –ø–∞–∫–µ—Ç–æ–≤ –¥–∞–Ω–Ω—ã—Ö. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –Ω—É–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –≤—Å—é –ø—Ä–æ—Ü–µ–¥—É—Ä—É –µ—â–µ —Ä–∞–∑.<br> 
</details>


![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/blemon1.jpg) 
–ö–∞—Ä—Ç–∏–Ω–∫–∞ 9. –°—Ç—Ä–∞–Ω–∏—á–∫–∞ BLE Monitor.
     
&emsp;–î–æ–±–∞–≤–ª–µ–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ª—É—á—à–µ–≥–æ —Å–∏–≥–Ω–∞–ª–∞ –æ—Ç –º–µ—Ç–∫–∏(–º–∞—è–∫–∞) —Å—Ä–µ–¥–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —à–ª—é–∑–æ–≤. –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–∫. –ö–∞–∂–¥—ã–π —à–ª—é–∑ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç —Ç–æ–ø–∏–∫ **r4s/DevId/rssi**. –ï—Å–ª–∏ —É –Ω–µ–≥–æ —Å–∏–≥–Ω–∞–ª –æ—Ç –º–µ—Ç–∫–∏(–º–∞—è–∫–∞)  —Å –±–æ–ª—å—à–∏–º —É—Ä–æ–≤–Ω–µ–º, –æ–Ω –ø—Ä–æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å–≤–æ–π —É—Ä–æ–≤–µ–Ω—å –≤ —ç—Ç–æ—Ç —Ç–æ–ø–∏–∫, –∞ —Ç–∞–∫–∂–µ —Å–≤–æ–π –Ω–æ–º–µ—Ä –≤ —Ç–æ–ø–∏–∫ **r4s/DevId/gtnum**. –ü–æ—Å–ª–µ —á–µ–≥–æ —à–ª—é–∑ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏, —Ä–∞–∑ –≤ 6 —Å–µ–∫—É–Ω–¥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–≤–æ–π —É—Ä–æ–≤–µ–Ω—å —Å–∏–≥–Ω–∞–ª–∞ –≤ —Ç–æ–ø–∏–∫–µ, —Ç–æ –µ—Å—Ç—å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤–µ–¥—É—â–∏–º. –û—Å—Ç–∞–ª—å–Ω—ã–µ —à–ª—é–∑—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç —É—Ä–æ–≤–µ–Ω—å –∏ –µ—Å—Ç—å –ª–∏ –µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ. –ï—Å–ª–∏ –∫–∞–∫–æ–π-—Ç–æ —à–ª—é–∑ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è –±–æ–ª–µ–µ 30 —Å–µ–∫—É–Ω–¥, –∏–ª–∏ –∂–µ –µ–≥–æ —É—Ä–æ–≤–µ–Ω—å –±–æ–ª—å—à–µ,  –æ–Ω —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤–µ–¥—É—â–∏–º. –õ—É—á—à–∏–π —É—Ä–æ–≤–µ–Ω—å –∏ –Ω–æ–º–µ—Ä —à–ª—é–∑–∞ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –≤–æ –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ—á–∫–µ RSSI –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ BLE –º–æ–Ω–∏—Ç–æ—Ä–∞. –í —Å—É—â–Ω–æ—Å—Ç—è—Ö –∫–∞–∂–¥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ç–æ–∂–µ –µ—Å—Ç—å –ª—É—á—à–∏–π —É—Ä–æ–≤–µ–Ω—å –∏ –Ω–æ–º–µ—Ä —à–ª—é–∑–∞:<br>
![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/blemon2.jpg)      
–ö–∞—Ä—Ç–∏–Ω–∫–∞ 10. –°—É—â–Ω–æ—Å—Ç–∏ –º–µ—Ç–∫–∏(–º–∞—è–∫–∞) –≤ Home Assistant.

## 5. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —ç–∫—Ä–∞–Ω–∞

&emsp;–í –ø–µ—Ä–≤–æ–π –≤–µ—Ä—Å–∏–∏ —à–ª—é–∑–∞ –æ—Å—Ç–∞–≤–∞–ª—Å—è –∑–∞–ø–∞—Å –∫–∞–∫ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π (~100–∫–ë–∞–π—Ç), —Ç–∞–∫ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä—É–µ–º–æ–π (~400–∫–ë–∞–π—Ç) —Å–≤–æ–±–æ–¥–Ω–æ–π –ø–∞–º—è—Ç–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–ª–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–æ—à–∏–≤–∫–∏, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É —ç–∫—Ä–∞–Ω–∞. –ö —Ç–æ–º—É –∂–µ —É –º–µ–Ω—è —É–∂–µ –±—ã–ª–∞ —Å–æ–±—Ä–∞–Ω–Ω–∞—è esp32 —Å —ç–∫—Ä–∞–Ω–æ–º [3.2" 320x240 –Ω–∞ —á–∏–ø–µ ili9341](https://www.aliexpress.com/item/32911859963.html?spm=a2g0s.9042311.0.0.274233edzZnjSp), —Ä–∞–±–æ—Ç–∞—é—â–∞—è —Å –ø—Ä–æ—à–∏–≤–∫–æ–π —Å —Å–∞–π—Ç–∞ [wifi-iot](https://wifi-iot.com/). –í–æ–∑–º–æ–∂–Ω–æ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è —à–ª—é–∑–∞ —É–∂–µ –≥–æ—Ç–æ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –Ω–∞ —á–∏–ø–∞—Ö ili9341, ili9342 –∏–ª–∏ ST7789. –í —à–ª—é–∑–µ —è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∏–∑ [Bodmer](https://github.com/Bodmer/TFT_eSPI), –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ–≤—Å–µ–º —Ö–æ—Ä–æ—à–æ, –Ω–æ –∫–∞–∫ –µ—Å—Ç—å –¥–ª—è esp-iot. –ü–∏–Ω—ã –¥–ª—è –ø–æ–∫–ª—é—á–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: MOSI-23, MISO-25, CLK-19, CS-16, DC-17, RST-18, LED-21. –ü–∏–Ω—ã –º–æ–∂–Ω–æ –ø–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–∏—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö. –ï—Å–ª–∏ PWR, RST, LED —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å 0, —Ç–æ —à–ª—é–∑ —ç—Ç–∏ –ø–∏–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ –±—É–¥–µ—Ç. –ï—Å—Ç—å —Ç–∞–∫–∂–µ –æ–ø—Ü–∏—è –ø–æ–≤–æ—Ä–æ—Ç–∞ —ç–∫—Ä–∞–Ω–∞ –Ω–∞ 180&deg;, –∞ —Ç–∞–∫–∂–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∏ —è—Ä–∫–æ—Å—Ç–∏ –¥–∏—Å–ø–ª–µ—è –ø–æ Mqtt, –∏c–ø–æ–ª—å–∑—É—è —Ç–æ–ø–∏–∫ **r4s/screen**. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —ç–∫—Ä–∞–Ω–∞ –Ω–∞ —à–∏–Ω–µ SPI –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ. –ü—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–≤–æ–¥–∞ –Ω–∞ —ç–∫—Ä–∞–Ω –∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ jpeg. –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å url –∫–∞—Ä—Ç–∏–Ω–∫–∏. –£ –º–æ–µ–π –∫–∞–º–µ—Ä—ã url —Ç–∞–∫–æ–π: **http://192.168.1.7/auto.jpg?usr=admin&pwd=admin**. –ö–∞—Ä—Ç–∏–Ω–∫–∞ –≥—Ä—É–∑–∏—Ç—Å—è –≤ –±—É—Ñ–µ—Ä —Ä–∞–∑–º–µ—Ä–æ–º 20-65 –∫–∏–ª–æ–±–∞–π—Ç –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏. –í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö. –ï—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏ –ø–æ https. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞. –ï—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–æ 4 –∫–∞—Ä—Ç–∏–Ω–æ–∫ –ø–æ Mqtt, –∏—Å–ø–æ–ª—å–∑—É—è —Ç–æ–ø–∏–∫–∏ **r4sx/jpg_url1...r4sx/jpg_url4** –∏ **r4sx/jpg_time**. –î–ª—è –æ—á–∏—Å—Ç–∫–∏ url –∫–∞—Ä—Ç–∏–Ω–∫–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ç–æ–ø–∏–∫ –Ω—É–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ —Å–∏–º–≤–æ–ª **#**. –ï—Å–ª–∏ –≤ Mqtt —ç—Ç–∏ —Ç–æ–ø–∏–∫–∏ –Ω–µ –ø—Ä–æ–ø–∏—Å–∞–Ω—ã, –∞ —Ç–∞–∫–∂–µ –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫, —ç—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ Mqtt. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω—É–ª–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ç–∞ –Ω–∞ —ç–∫—Ä–∞–Ω. –î–ª–∏–Ω–∞ –±—É—Ñ–µ—Ä–∞ —Å—Å—ã–ª–∫–∏ –ø–æ–∫–∞ 384 –±–∞–π—Ç–∞. –î–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º –≤–∏–¥–µ –ø–æ–≥–æ–¥—ã —Å —Å–∞–π—Ç–∞ wttr.in. –í –ø—Ä–∏–Ω—Ü–∏–ø–µ, —ç—Ç–æ –º–æ–∂–µ—Ç –ª—é–±–æ–π —Å–∞–π—Ç, –æ—Ç–¥–∞—é—â–∏–π —Ç–µ–∫—Å—Ç –∏ –¥–æ–ø—É—Å–∫–∞—é—â–∏–π —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ. –ï—Å–ª–∏ —Å—Å—ã–ª–∫–∞ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç—Ä–æ–∫–∏ **http://** –∏–ª–∏ **https://**, —Ç–æ —à–ª—é–∑ —Å—á–∏—Ç–∞–µ—Ç —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã–º —Ç–µ–∫—Å—Ç–æ–º –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –Ω–∞ —ç–∫—Ä–∞–Ω–µ. –î–æ—Å—Ç—É–ø–Ω–æ 2 —à—Ä–∏—Ñ—Ç–∞ –∏ 10 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ü–≤–µ—Ç–æ–≤. –£–ø—Ä–∞–≤–ª—è—é—â–∏–µ —Å–∏–º–≤–æ–ª—ã: \ \ –∏–ª–∏ \n - –ø–µ—Ä–µ–≤–æ–¥ —Å—Ç—Ä–æ–∫–∏, \F  - —à—Ä–∏—Ñ—Ç 26 –ø–∏–∫—Å–µ–ª–µ–π –∏ –ø–µ—Ä–µ–≤–æ–¥ —Å—Ç—Ä–æ–∫–∏, \f - —à—Ä–∏—Ñ—Ç 16 –ø–∏–∫—Å–µ–ª–µ–π –∏ –ø–µ—Ä–µ–≤–æ–¥ —Å—Ç—Ä–æ–∫–∏, \0 ... \9 - —Ü–≤–µ—Ç–∞. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –∫–∏—Ä–∏–ª–ª–∏—Ü–∞, –ø—Ä–æ–≤–µ—Ä—è–ª, –ø—Ä–∞–≤–¥–∞, —Ç–æ–ª—å–∫–æ –∏–∑ mosquitto. –û–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —é–Ω–∏–∫–æ–¥ –ø–æ —Ñ–∞–∫—Ç—É, –∫–∞–∫ –¥—Ä—É–≥–∏–µ –±—Ä–æ–∫–µ—Ä—ã, –Ω–µ –∑–Ω–∞—é. –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ —ç–∫—Ä–∞–Ω –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ 11.
<br>

![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/mytft3.jpg)
–ö–∞—Ä—Ç–∏–Ω–∫–∞ 11. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.<br><br>

&emsp;–ù–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ 12 –ø—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ –Ω–∞ —ç–∫—Ä–∞–Ω Mqtt –ø–æ–≥–æ–¥—ã —Å —Å–∞–π—Ç–∞ wttr.in:
<td>https://wttr.in/–î–æ–Ω–µ—Ü–∫?format=\F\6+%25l%20\\\4–¢–µ–º–ø:+\0%25t(%25f)\\\4–î–∞–≤–ª:\0+%25P\\\4–í–ª–∞–∂–Ω:\0+%25h\\\6+%25c+%25w+UV:+%25u\f\4–í–æ—Å—Ö–æ–¥:\0+%25D+\4–ó–∞–∫–∞—Ç:\0+%25d</td><br> 

![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/mytft10.jpg)
–ö–∞—Ä—Ç–∏–Ω–∫–∞ 12. –ü–æ–≥–æ–¥–∞.<br><br>

&emsp;–ù–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ 13 –ø—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ –Ω–∞ —ç–∫—Ä–∞–Ω Mqtt —Å—Ç—Ä–æ–∫–∏ (—Å–∏–º–≤–æ–ª –≥—Ä–∞–¥—É—Å–∞ –º–æ–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ –Ω–∞ —ç–∫—Ä–∞–Ω –∏—Å–ø–æ–ª—å–∑—É—è –æ–±—Ä–∞—Ç–Ω—ã–π –∞–ø–æ—Å—Ç—Ä–æ—Ñ):
<td>\F\0` English \1color \2text\3 example\n\4–†—É—Å—Å–∫–∏–π \5—Ü–≤–µ—Ç–Ω–æ–π \6—Ç–µ–∫—Å—Ç\n\7text1 \8text2 \9text3\f\0` English \1color \2text\3 example\n\4–†—É—Å—Å–∫–∏–π \5—Ü–≤–µ—Ç–Ω–æ–π \6—Ç–µ–∫—Å—Ç\n\7text1 \8text2 \9text3</td><br>    
  
![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/mytft9.jpg)
–ö–∞—Ä—Ç–∏–Ω–∫–∞ 13. –¢–µ–∫—Å—Ç.<br><br>

&emsp; –°—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Å–∞–º–∞ TFT –ø–ª–∞—Ç–∞ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞–∫ WiFi, —Ç–∞–∫ –∏ BLE. –ò –¥–∞–∂–µ –µ—Å–ª–∏ –∞–Ω—Ç–µ–Ω–Ω–∞ esp32 –≤—ã–≥–ª—è–¥—ã–≤–∞–µ—Ç –∏–∑-–ø–æ–¥ —ç–∫—Ä–∞–Ω–∞, —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—å —Ç–∞–∫–æ–≥–æ –±—É—Ç–µ—Ä–±—Ä–æ–¥–∞ –∑–∞–º–µ—Ç–Ω–æ –º–µ–Ω—å—à–µ –æ–±—ã—á–Ω–æ–π esp32. –†–µ–∫–æ–º–µ–Ω–¥—É—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å —ç–∫—Ä–∞–Ω–æ–º –≤–∞—Ä–∏–∞–Ω—Ç esp32 —Å –≤–Ω–µ—à–Ω–µ–π –∞–Ω—Ç–µ–Ω–Ω–æ–π. –£ –º–µ–Ω—è –≤ —à–ª—é–∑–µ —Å —ç–∫—Ä–∞–Ω–æ–º –∑–∞–º–µ–Ω–∞ esp32 –Ω–∞ –≤–∞—Ä–∏–∞–Ω—Ç —Å —Ä–∞–∑—ä–µ–º–æ–º –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–Ω–µ—à–Ω–µ–π –∞–Ω—Ç–µ–Ω–Ω—ã –¥–∞–ª–∞ –ø—Ä–∏—Ä–æ—Å—Ç —É—Ä–æ–≤–Ω–µ–π WIFI –∏ BLE –ø—Ä–∏–º–µ—Ä–Ω–æ –Ω–∞ 15-20dBm.<br>
&emsp; –ï—Å–ª–∏ –∂–µ —ç–∫—Ä–∞–Ω –Ω–µ –Ω—É–∂–µ–Ω, —Ç–æ –Ω—É–∂–Ω–æ –ø–æ—Å–ª–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏  esp32 –ø–æ–¥—Å–æ–µ–¥–∏–Ω–∏—Ç—å –µ–µ –∫ –∏—Å—Ç–æ—á–Ω–∏–∫—É –ø–∏—Ç–∞–Ω–∏—è –∏ —Å–ø—Ä—è—Ç–∞—Ç—å –≥–¥–µ-–Ω–∏–±—É–¥—å –Ω–∞ –∫—É—Ö–Ω–µ.<br>

## 6. –°–æ–≤–º–µ—Å—Ç–∏–º—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
–ï—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å —à–ª—é–∑ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ, –±–µ–∑ –ø–∞–π–∫–∏, –¥–∞ –µ—â–µ –∏ —Å –ø—Ä–∏–ª–∏—á–Ω—ã–º –∫–æ—Ä–ø—É—Å–æ–º, —Å—Ç–æ–∏—Ç –ø—Ä–∏—Å–º–æ—Ç—Ä–µ—Ç—å—Å—è –∫ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º. –ò—Ö –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞—Ç—å. –ù–∏–∂–µ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –º–Ω–æ–π —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞. –î–ª—è –ø—Ä–æ—à–∏–≤–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –ø—Ä–æ–≥—Ä–∞–º–º–∞ [flash_download_tools](https://www.espressif.com/en/support/download/other-tools).

#### [TTGO T-Watcher](http://www.lilygo.cn/prod_view.aspx?TypeId=50033&Id=1160) (LILYGO¬Æ TTGO T4 –≤ –∫–æ—Ä–ø—É—Å–µ).<br>
![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/mytft4.jpg)
<br>–ö–∞—Ä—Ç–∏–Ω–∫–∞ 14. TTGO T-Watcher.<br><br>
–Ø –ø—Ä–æ–≤–µ—Ä—è–ª —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —à–ª—é–∑–∞ –Ω–∞ TTGO T4 –≤–µ—Ä—Å–∏–∏ 1.3. –ü—Ä–æ—à–∏–≤–∞–µ—Ç—Å—è –æ–Ω —á–µ—Ä–µ–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π USB —Ä–∞–∑—ä–µ–º, –ø–µ—Ä–µ–¥ –ø—Ä–æ—à–∏–≤–∫–æ–π —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω—É–∂–Ω–æ —Å–æ–µ–¥–∏–Ω–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç—ã 6 –∏ 7 (gpio0 –∏ gnd) –≤ –Ω–∏–∂–Ω–µ–º —Ä—è–¥—É —Ä–∞–∑—ä–µ–º–∞ (–∫–∞—Ä—Ç–∏–Ω–∫–∞ 15). –í–æ–∑–º–æ–∂–Ω–∞ –ø—Ä–æ—à–∏–≤–∫–∞ –∏ –±–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ–º—ã—á–µ–∫, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—ã. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —ç–∫—Ä–∞–Ω–∞ –¥–ª—è –≤–µ—Ä—Å–∏–∏ 1.3: 12-MISO, 23-MOSI, 18-CLK, 27-CS, 32-DC, 5-RES, 4-LED, 0-PWR, –∏ –¥–ª—è –≤–µ—Ä—Å–∏–∏ 1.2: 12-MISO, 23-MOSI, 18-CLK, 27-CS, 26-DC, 5-RES, 4-LED, 0-PWR. –í –≤–µ—Ä—Å–∏–∏ 1.2 –Ω–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∫–ª—é—á–µ–Ω–∏–µ–º –∏ –≤—ã–∫–ª—é—á–µ–Ω–∏–µ–º —ç–∫—Ä–∞–Ω–∞. –ö–Ω–æ–ø–∫–∏ —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑ 38-Port1, 37-Port2, 39-Port3. –®–∏–Ω–∞ I2C: SCL-22, SDA-21.<br>
![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/mytft5.jpg)
<br>–ö–∞—Ä—Ç–∏–Ω–∫–∞ 15. –°–æ–µ–¥–∏–Ω–∏—Ç—å 6 –∏ 7 –ø–∏–Ω—ã —Ä–∞–∑—ä–µ–º–∞ –ø–µ—Ä–µ–¥ –ø—Ä–æ—à–∏–≤–∫–æ–π TTGO T-Watcher.<br><br>

#### [M5Stack BASIC Kit](https://docs.m5stack.com/en/core/basic)<br>
![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/mytft6.jpg)
<br>–ö–∞—Ä—Ç–∏–Ω–∫–∞ 16. M5Stack BASIC Kit.<br><br>
–ö–∞–∫ —è –ø–æ–Ω—è–ª, —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ M5Stack Basic —à–ª–∏ —Å —ç–∫—Ä–∞–Ω–æ–º –Ω–∞ ili9341, –∏ –Ω–∞ —ç—Ç–∏—Ö –≤–µ—Ä—Å–∏—è—Ö [—Ä–∞–±–æ—Ç–∞–ª–∞ –∏ —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è —à–ª—é–∑–∞](https://github.com/alutov/ESP32-R4sGate-for-Redmond/issues/16). 
–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —ç–∫—Ä–∞–Ω–∞ –¥–ª—è —ç—Ç–æ–π –≤–µ—Ä—Å–∏–∏: 19-MISO, 23-MOSI, 18-CLK, 14-CS, 27-DC, 33-RES, 32-LED, 0-PWR. –ù–æ–≤—ã–µ –≤–µ—Ä—Å–∏–∏ —É–∂–µ –∏–¥—É—Ç —Å —ç–∫—Ä–∞–Ω–æ–º –Ω–∞ ili9342. –ù–∞—á–∏–Ω–∞—è —Å –≤–µ—Ä—Å–∏–∏ 2021.10.29 –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —ç–∫—Ä–∞–Ω–∞ –Ω–∞ ili9342. –Ø –ø—Ä–æ–≤–µ—Ä—è–ª —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —à–ª—é–∑–∞ –Ω–∞ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ M5Stack BASIC Kit. –ü—Ä–æ—à–∏–≤–∞–µ—Ç—Å—è –æ–Ω —á–µ—Ä–µ–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π USB —Ä–∞–∑—ä–µ–º, –ø–µ—Ä–µ–¥ –ø—Ä–æ—à–∏–≤–∫–æ–π —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω—É–∂–Ω–æ —Å–æ–µ–¥–∏–Ω–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–Ω—Ç–∞–∫—Ç –≤ –≤–µ—Ä—Ö–Ω–µ–º —Ä—è–¥—É –∏ 4 –≤ –Ω–∏–∂–Ω–µ–º —Ä—è–¥—É (gnd –∏ gpio0) —Ä–∞–∑—ä–µ–º–∞ (–∫–∞—Ä—Ç–∏–Ω–∫–∞ 17). –í–æ–∑–º–æ–∂–Ω–∞ –ø—Ä–æ—à–∏–≤–∫–∞ –∏ –±–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ–º—ã—á–µ–∫, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—ã. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —ç–∫—Ä–∞–Ω–∞ –¥–ª—è –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏: 23-MISO, 23-MOSI, 18-CLK, 14-CS, 27-DC, 33-RES, 32-LED, 0-PWR. –ö–Ω–æ–ø–∫–∏ —Å–ª–µ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ 39-Port1, 38-Port2, 37-Port3. –®–∏–Ω–∞ I2C: SCL-22, SDA-21.<br>
–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è [**M5Stack Tough**](https://docs.m5stack.com/en/core/tough): 23-MISO, 23-MOSI, 18-CLK, 5-CS, 15-DC, 44-RES, 47-LED, 46-PWR. –®–∏–Ω–∞ I2C: SCL-22, SDA-21. –ë–µ–∑ I2C —ç–∫—Ä–∞–Ω –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è.<br>  
     
![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/mytft7.jpg)
<br>–ö–∞—Ä—Ç–∏–Ω–∫–∞ 17. –°–æ–µ–¥–∏–Ω–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–Ω—Ç–∞–∫—Ç –≤ –≤–µ—Ä—Ö–Ω–µ–º —Ä—è–¥—É –∏ 4 –≤ –Ω–∏–∂–Ω–µ–º —Ä—è–¥—É (gnd –∏ gpio0) –ø–µ—Ä–µ–¥ –ø—Ä–æ—à–∏–≤–∫–æ–π M5Stack BASIC Kit.<br><br>

#### [ATOM-LITE-ESP32-DEVELOPMENT-KIT](https://docs.m5stack.com/en/core/atom_lite)<br>
![PROJECT_PHOTO](https://github.com/alutov/ESP32-R4sGate-for-Redmond/blob/master/jpg/mytft8.jpg)
<br>–ö–∞—Ä—Ç–∏–Ω–∫–∞ 18. ATOM-LITE-ESP32-DEVELOPMENT-KIT.<br><br>
     –ü—Ä–æ—à–∏–≤–∞–µ—Ç—Å—è –∞—Ç–æ–º –ø–æ usb –±–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—Ä–µ–º—ã—á–µ–∫. –ö–Ω–æ–ø–∫—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è-–≤—ã–∫–ª—é—á–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –∏–∑ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (39-Port1), —Å–≤–µ—Ç–æ–¥–∏–æ–¥ –ø–æ–∫–∞ –≤ –ø—Ä–æ—à–∏–≤–∫–µ –Ω–µ –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω. IR LED –Ω–∞ 12 gpio –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –¥–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è. –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∫–æ–º–ø–∞–∫—Ç–Ω–æ–µ (24 * 24 * 10 mm), devkit esp32 –ø–æ —Ä–∞–∑–º–µ—Ä–∞–º –±–æ–ª—å—à–µ.
     
     
## 7. –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –ª–∏—Ü–µ–Ω–∑–∏—è
&emsp; –î–ª—è —Å–±–æ—Ä–∫–∏ –±–∏–Ω–∞—Ä–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª [Espressif IoT Development Framework.](https://docs.espressif.com/projects/esp-idf/en/latest/esp32/). –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–∏—Ü–µ–Ω–∑–∏—è MIT. –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Å–±–æ—Ä–∫–∏ –≤ —Å—Ä–µ–¥–µ PlatformIO, —Å–ø–∞—Å–∏–±–æ [bvp](https://github.com/bvp),  –µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–µ [–∑–¥–µ—Å—å](https://github.com/alutov/ESP32-R4sGate-for-Redmond/pull/89).
<details>
<summary>–ü–æ–¥—Ä–æ–±–Ω–µ–µ...</summary>

## PlatformIO
–≠—Ç–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —Å–±–æ—Ä–∫–∏ –ø—Ä–æ—à–∏–≤–æ–∫ –¥–ª—è –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤. –£–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–µ–º —Å–±–æ—Ä–∫–∏, –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –ø—Ä–æ–µ–∫—Ç–∞. –í—Å—ë –Ω—É–∂–Ω–æ–µ —Å–∫–∞—á–∞–µ—Ç —Å–∞–º–∞. –°–æ —Å–ø–∏—Å–∫–æ–º –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º –º–æ–∂–Ω–æ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è [—Ç—É—Ç](https://registry.platformio.org/search?t=platform), –∞ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤ - [—Ç—É—Ç](https://registry.platformio.org/search?t=tool&q=keyword%3Aframework).

platformio.ini - —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è PlatformIO
–°–æ–±—Ä–∞—Ç—å —Ç–∞–∫ - `pio run -t build` –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ `pio run`
–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø—Ä–æ—à–∏–≤–∫—É - `pio run -t upload`
–ü–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ–ø—Ä–∞–≤–∏—Ç—å `upload_port` –∏ `monitor_port`.
–î–ª—è Win32 –∑–Ω–∞—á–µ–Ω–∏–µ –±—É–¥–µ—Ç –≤–∏–¥–∞ `COM4` (–ø–æ—Å—Ç–∞–≤–∏—Ç—å —Å–≤–æ–π –Ω–æ–º–µ—Ä –ø–æ—Ä—Ç–∞, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø—Ä–æ—à–∏–≤–∞–ª—å—â–∏–∫).
–î–ª—è Linux - –±—É–¥–µ—Ç `/dev/ttyUSB0` (—Ç–∞–∫ –∂–µ –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Å–≤–æ–π –Ω–æ–º–µ—Ä –ø–æ—Ä—Ç–∞, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø—Ä–æ—à–∏–≤–∞–ª—å—â–∏–∫).
–î–ª—è macOS - –∫–∞–∫ –≤ –ø—Ä–∏–ª–∞–≥–∞–µ–º–æ–º –ø—Ä–∏–º–µ—Ä–µ.

## Clang-format
–í —Ñ–∞–π–ª–µ –æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞, —Å–æ–≥–ª–∞—Å–Ω–æ –∫–æ—Ç–æ—Ä—ã–º –∫–æ–¥ –ø—Ä–∏–≤–æ–¥–∏—Ç—Å—è –∫ –Ω—É–∂–Ω–æ–º—É —Å—Ç–∏–ª—é. –ù–µ–æ–±—Ö–æ–¥–∏–º —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π `clang-format`.     
</details>

<br>
